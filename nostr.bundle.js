/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/nostr-tools@1.15.0/lib/nostr.bundle.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var NostrTools=(()=>{var n=Object.defineProperty,e=Object.getOwnPropertyDescriptor,t=Object.getOwnPropertyNames,r=Object.prototype.hasOwnProperty,i=(e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:!0})},o={};function s(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function a(n,...e){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}i(o,{Kind:()=>ye,SimplePool:()=>Ke,eventsGenerator:()=>Ne,finishEvent:()=>we,fj:()=>Ue,generatePrivateKey:()=>ie,getBlankEvent:()=>ge,getEventHash:()=>me,getPublicKey:()=>oe,getSignature:()=>Ae,matchFilter:()=>Be,matchFilters:()=>Se,mergeFilters:()=>Ie,nip04:()=>Tt,nip05:()=>$t,nip06:()=>Pt,nip10:()=>qr,nip13:()=>Pr,nip18:()=>Dr,nip19:()=>je,nip21:()=>Gr,nip25:()=>Qr,nip26:()=>ei,nip27:()=>ii,nip28:()=>ci,nip39:()=>yi,nip42:()=>bi,nip44:()=>vi,nip57:()=>zi,nip98:()=>Zi,parseReferences:()=>_t,relayInit:()=>$e,serializeEvent:()=>be,signEvent:()=>ke,utils:()=>se,validateEvent:()=>Ee,verifiedSymbol:()=>pe,verifySignature:()=>xe});var c={number:s,bool:function(n){if("boolean"!=typeof n)throw new Error(`Expected boolean, not ${n}`)},bytes:a,hash:function(n){if("function"!=typeof n||"function"!=typeof n.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");s(n.outputLen),s(n.blockLen)},exists:function(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")},output:function(n,e){a(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}},l="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,u=n=>n instanceof Uint8Array,h=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),d=(n,e)=>n<<32-e|n>>>e;if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");var f=Array.from({length:256},((n,e)=>e.toString(16).padStart(2,"0")));function p(n){if(!u(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=f[n[t]];return e}function y(n){if("string"!=typeof n)throw new Error("hex string expected, got "+typeof n);const e=n.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let e=0;e<t.length;e++){const r=2*e,i=n.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[e]=o}return t}function g(n){if("string"!=typeof n)throw new Error("utf8ToBytes expected string, got "+typeof n);return new Uint8Array((new TextEncoder).encode(n))}function w(n){if("string"==typeof n&&(n=g(n)),!u(n))throw new Error("expected Uint8Array, got "+typeof n);return n}function b(...n){const e=new Uint8Array(n.reduce(((n,e)=>n+e.length),0));let t=0;return n.forEach((n=>{if(!u(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length})),e}var m=class{clone(){return this._cloneInto()}};function v(n,e){if(void 0!==e&&("object"!=typeof e||(t=e,"[object Object]"!==Object.prototype.toString.call(t)||t.constructor!==Object)))throw new Error("Options should be object or undefined");var t;return Object.assign(n,e)}function E(n){const e=e=>n().update(w(e)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function x(n=32){if(l&&"function"==typeof l.getRandomValues)return l.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}var k=class extends m{constructor(n,e,t,r){super(),this.blockLen=n,this.outputLen=e,this.padOffset=t,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(n),this.view=h(this.buffer)}update(n){c.exists(this);const{view:e,buffer:t,blockLen:r}=this,i=(n=w(n)).length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)t.set(n.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(e,0),this.pos=0);else{const e=h(n);for(;r<=i-o;o+=r)this.process(e,o)}}return this.length+=n.length,this.roundClean(),this}digestInto(n){c.exists(this),c.output(n,this),this.finished=!0;const{buffer:e,view:t,blockLen:r,isLE:i}=this;let{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(t,0),o=0);for(let n=o;n<r;n++)e[n]=0;!function(n,e,t,r){if("function"==typeof n.setBigUint64)return n.setBigUint64(e,t,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(t>>i&o),a=Number(t&o),c=r?4:0,l=r?0:4;n.setUint32(e+c,s,r),n.setUint32(e+l,a,r)}(t,r-8,BigInt(8*this.length),i),this.process(t,0);const s=h(n),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=a/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let n=0;n<l;n++)s.setUint32(4*n,u[n],i)}digest(){const{buffer:n,outputLen:e}=this;this.digestInto(n);const t=n.slice(0,e);return this.destroy(),t}_cloneInto(n){n||(n=new this.constructor),n.set(...this.get());const{blockLen:e,buffer:t,length:r,finished:i,destroyed:o,pos:s}=this;return n.length=r,n.pos=s,n.finished=i,n.destroyed=o,r%e&&n.buffer.set(t),n}},A=(n,e,t)=>n&e^n&t^e&t,B=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),S=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),I=new Uint32Array(64),U=class extends k{constructor(){super(64,32,8,!1),this.A=0|S[0],this.B=0|S[1],this.C=0|S[2],this.D=0|S[3],this.E=0|S[4],this.F=0|S[5],this.G=0|S[6],this.H=0|S[7]}get(){const{A:n,B:e,C:t,D:r,E:i,F:o,G:s,H:a}=this;return[n,e,t,r,i,o,s,a]}set(n,e,t,r,i,o,s,a){this.A=0|n,this.B=0|e,this.C=0|t,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(n,e){for(let t=0;t<16;t++,e+=4)I[t]=n.getUint32(e,!1);for(let n=16;n<64;n++){const e=I[n-15],t=I[n-2],r=d(e,7)^d(e,18)^e>>>3,i=d(t,17)^d(t,19)^t>>>10;I[n]=i+I[n-7]+r+I[n-16]|0}let{A:t,B:r,C:i,D:o,E:s,F:a,G:c,H:l}=this;for(let n=0;n<64;n++){const e=l+(d(s,6)^d(s,11)^d(s,25))+((u=s)&a^~u&c)+B[n]+I[n]|0,h=(d(t,2)^d(t,13)^d(t,22))+A(t,r,i)|0;l=c,c=a,a=s,s=o+e|0,o=i,i=r,r=t,t=e+h|0}var u;t=t+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(t,r,i,o,s,a,c,l)}roundClean(){I.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},L=class extends U{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},O=E((()=>new U)),_=(E((()=>new L)),{});i(_,{bitGet:()=>Y,bitLen:()=>J,bitMask:()=>X,bitSet:()=>Q,bytesToHex:()=>N,bytesToNumberBE:()=>z,bytesToNumberLE:()=>P,concatBytes:()=>Z,createHmacDrbg:()=>tn,ensureBytes:()=>M,equalBytes:()=>G,hexToBytes:()=>q,hexToNumber:()=>j,numberToBytesBE:()=>F,numberToBytesLE:()=>D,numberToHexUnpadded:()=>K,numberToVarBytesBE:()=>V,utf8ToBytes:()=>W,validateObject:()=>on});var T=BigInt(0),C=BigInt(1),H=BigInt(2),R=n=>n instanceof Uint8Array,$=Array.from({length:256},((n,e)=>e.toString(16).padStart(2,"0")));function N(n){if(!R(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=$[n[t]];return e}function K(n){const e=n.toString(16);return 1&e.length?`0${e}`:e}function j(n){if("string"!=typeof n)throw new Error("hex string expected, got "+typeof n);return BigInt(""===n?"0":`0x${n}`)}function q(n){if("string"!=typeof n)throw new Error("hex string expected, got "+typeof n);const e=n.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let e=0;e<t.length;e++){const r=2*e,i=n.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[e]=o}return t}function z(n){return j(N(n))}function P(n){if(!R(n))throw new Error("Uint8Array expected");return j(N(Uint8Array.from(n).reverse()))}function F(n,e){return q(n.toString(16).padStart(2*e,"0"))}function D(n,e){return F(n,e).reverse()}function V(n){return q(K(n))}function M(n,e,t){let r;if("string"==typeof e)try{r=q(e)}catch(t){throw new Error(`${n} must be valid hex string, got "${e}". Cause: ${t}`)}else{if(!R(e))throw new Error(`${n} must be hex string or Uint8Array`);r=Uint8Array.from(e)}const i=r.length;if("number"==typeof t&&i!==t)throw new Error(`${n} expected ${t} bytes, got ${i}`);return r}function Z(...n){const e=new Uint8Array(n.reduce(((n,e)=>n+e.length),0));let t=0;return n.forEach((n=>{if(!R(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length})),e}function G(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function W(n){if("string"!=typeof n)throw new Error("utf8ToBytes expected string, got "+typeof n);return new Uint8Array((new TextEncoder).encode(n))}function J(n){let e;for(e=0;n>T;n>>=C,e+=1);return e}function Y(n,e){return n>>BigInt(e)&C}var Q=(n,e,t)=>n|(t?C:T)<<BigInt(e),X=n=>(H<<BigInt(n-1))-C,nn=n=>new Uint8Array(n),en=n=>Uint8Array.from(n);function tn(n,e,t){if("number"!=typeof n||n<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof t)throw new Error("hmacFn must be a function");let r=nn(n),i=nn(n),o=0;const s=()=>{r.fill(1),i.fill(0),o=0},a=(...n)=>t(i,r,...n),c=(n=nn())=>{i=a(en([0]),n),r=a(),0!==n.length&&(i=a(en([1]),n),r=a())},l=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let n=0;const t=[];for(;n<e;){r=a();const e=r.slice();t.push(e),n+=r.length}return Z(...t)};return(n,e)=>{let t;for(s(),c(n);!(t=e(l()));)c();return s(),t}}var rn={bigint:n=>"bigint"==typeof n,function:n=>"function"==typeof n,boolean:n=>"boolean"==typeof n,string:n=>"string"==typeof n,isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>"function"==typeof n&&Number.isSafeInteger(n.outputLen)};function on(n,e,t={}){const r=(e,t,r)=>{const i=rn[t];if("function"!=typeof i)throw new Error(`Invalid validator "${t}", expected function`);const o=n[e];if(!(r&&void 0===o||i(o,n)))throw new Error(`Invalid param ${String(e)}=${o} (${typeof o}), expected ${t}`)};for(const[n,t]of Object.entries(e))r(n,t,!1);for(const[n,e]of Object.entries(t))r(n,e,!0);return n}var sn=BigInt(0),an=BigInt(1),cn=BigInt(2),ln=BigInt(3),un=BigInt(4),hn=BigInt(5),dn=BigInt(8);BigInt(9),BigInt(16);function fn(n,e){const t=n%e;return t>=sn?t:e+t}function pn(n,e,t){if(t<=sn||e<sn)throw new Error("Expected power/modulo > 0");if(t===an)return sn;let r=an;for(;e>sn;)e&an&&(r=r*n%t),n=n*n%t,e>>=an;return r}function yn(n,e,t){let r=n;for(;e-- >sn;)r*=r,r%=t;return r}function gn(n,e){if(n===sn||e<=sn)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=fn(n,e),r=e,i=sn,o=an,s=an,a=sn;for(;t!==sn;){const n=r/t,e=r%t,c=i-s*n,l=o-a*n;r=t,t=e,i=s,o=a,s=c,a=l}if(r!==an)throw new Error("invert: does not exist");return fn(i,e)}function wn(n){if(n%un===ln){const e=(n+an)/un;return function(n,t){const r=n.pow(t,e);if(!n.eql(n.sqr(r),t))throw new Error("Cannot find square root");return r}}if(n%dn===hn){const e=(n-hn)/dn;return function(n,t){const r=n.mul(t,cn),i=n.pow(r,e),o=n.mul(t,i),s=n.mul(n.mul(o,cn),i),a=n.mul(o,n.sub(s,n.ONE));if(!n.eql(n.sqr(a),t))throw new Error("Cannot find square root");return a}}return function(n){const e=(n-an)/cn;let t,r,i;for(t=n-an,r=0;t%cn===sn;t/=cn,r++);for(i=cn;i<n&&pn(i,e,n)!==n-an;i++);if(1===r){const e=(n+an)/un;return function(n,t){const r=n.pow(t,e);if(!n.eql(n.sqr(r),t))throw new Error("Cannot find square root");return r}}const o=(t+an)/cn;return function(n,s){if(n.pow(s,e)===n.neg(n.ONE))throw new Error("Cannot find square root");let a=r,c=n.pow(n.mul(n.ONE,i),t),l=n.pow(s,o),u=n.pow(s,t);for(;!n.eql(u,n.ONE);){if(n.eql(u,n.ZERO))return n.ZERO;let e=1;for(let t=n.sqr(u);e<a&&!n.eql(t,n.ONE);e++)t=n.sqr(t);const t=n.pow(c,an<<BigInt(a-e-1));c=n.sqr(t),l=n.mul(l,t),u=n.mul(u,c),a=e}return l}}(n)}var bn=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function mn(n,e){const t=void 0!==e?e:n.toString(2).length;return{nBitLength:t,nByteLength:Math.ceil(t/8)}}var vn=BigInt(0),En=BigInt(1);function xn(n){return on(n.Fp,bn.reduce(((n,e)=>(n[e]="function",n)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),on(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...mn(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}var{bytesToNumberBE:kn,hexToBytes:An}=_,Bn={Err:class extends Error{constructor(n=""){super(n)}},_parseInt(n){const{Err:e}=Bn;if(n.length<2||2!==n[0])throw new e("Invalid signature integer tag");const t=n[1],r=n.subarray(2,t+2);if(!t||r.length!==t)throw new e("Invalid signature integer: wrong length");if(128&r[0])throw new e("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:kn(r),l:n.subarray(t+2)}},toSig(n){const{Err:e}=Bn,t="string"==typeof n?An(n):n;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let r=t.length;if(r<2||48!=t[0])throw new e("Invalid signature tag");if(t[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:i,l:o}=Bn._parseInt(t.subarray(2)),{d:s,l:a}=Bn._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:s}},hexFromSig(n){const e=n=>8&Number.parseInt(n[0],16)?"00"+n:n,t=n=>{const e=n.toString(16);return 1&e.length?`0${e}`:e},r=e(t(n.s)),i=e(t(n.r)),o=r.length/2,s=i.length/2,a=t(o),c=t(s);return`30${t(s+o+4)}02${c}${i}02${a}${r}`}},Sn=BigInt(0),In=BigInt(1),Un=(BigInt(2),BigInt(3));BigInt(4);function Ln(n){const e=function(n){const e=xn(n);on(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:r,a:i}=e;if(t){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof t||"bigint"!=typeof t.beta||"function"!=typeof t.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(n),{Fp:t}=e,r=e.toBytes||((n,e,r)=>{const i=e.toAffine();return Z(Uint8Array.from([4]),t.toBytes(i.x),t.toBytes(i.y))}),i=e.fromBytes||(n=>{const e=n.subarray(1);return{x:t.fromBytes(e.subarray(0,t.BYTES)),y:t.fromBytes(e.subarray(t.BYTES,2*t.BYTES))}});function o(n){const{a:r,b:i}=e,o=t.sqr(n),s=t.mul(o,n);return t.add(t.add(s,t.mul(n,r)),i)}if(!t.eql(t.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(n){return"bigint"==typeof n&&Sn<n&&n<e.n}function a(n){if(!s(n))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(n){const{allowedPrivateKeyLengths:t,nByteLength:r,wrapPrivateKey:i,n:o}=e;if(t&&"bigint"!=typeof n){if(n instanceof Uint8Array&&(n=N(n)),"string"!=typeof n||!t.includes(n.length))throw new Error("Invalid key");n=n.padStart(2*r,"0")}let s;try{s="bigint"==typeof n?n:z(M("private key",n,r))}catch(e){throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof n}`)}return i&&(s=fn(s,o)),a(s),s}const l=new Map;function u(n){if(!(n instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(n,e,r){if(this.px=n,this.py=e,this.pz=r,null==n||!t.isValid(n))throw new Error("x required");if(null==e||!t.isValid(e))throw new Error("y required");if(null==r||!t.isValid(r))throw new Error("z required")}static fromAffine(n){const{x:e,y:r}=n||{};if(!n||!t.isValid(e)||!t.isValid(r))throw new Error("invalid affine point");if(n instanceof h)throw new Error("projective point not allowed");const i=n=>t.eql(n,t.ZERO);return i(e)&&i(r)?h.ZERO:new h(e,r,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(n){const e=t.invertBatch(n.map((n=>n.pz)));return n.map(((n,t)=>n.toAffine(e[t]))).map(h.fromAffine)}static fromHex(n){const e=h.fromAffine(i(M("pointHex",n)));return e.assertValidity(),e}static fromPrivateKey(n){return h.BASE.multiply(c(n))}_setWindowSize(n){this._WINDOW_SIZE=n,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:n,y:r}=this.toAffine();if(!t.isValid(n)||!t.isValid(r))throw new Error("bad point: x or y not FE");const i=t.sqr(r),s=o(n);if(!t.eql(i,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:n}=this.toAffine();if(t.isOdd)return!t.isOdd(n);throw new Error("Field doesn't support isOdd")}equals(n){u(n);const{px:e,py:r,pz:i}=this,{px:o,py:s,pz:a}=n,c=t.eql(t.mul(e,a),t.mul(o,i)),l=t.eql(t.mul(r,a),t.mul(s,i));return c&&l}negate(){return new h(this.px,t.neg(this.py),this.pz)}double(){const{a:n,b:r}=e,i=t.mul(r,Un),{px:o,py:s,pz:a}=this;let c=t.ZERO,l=t.ZERO,u=t.ZERO,d=t.mul(o,o),f=t.mul(s,s),p=t.mul(a,a),y=t.mul(o,s);return y=t.add(y,y),u=t.mul(o,a),u=t.add(u,u),c=t.mul(n,u),l=t.mul(i,p),l=t.add(c,l),c=t.sub(f,l),l=t.add(f,l),l=t.mul(c,l),c=t.mul(y,c),u=t.mul(i,u),p=t.mul(n,p),y=t.sub(d,p),y=t.mul(n,y),y=t.add(y,u),u=t.add(d,d),d=t.add(u,d),d=t.add(d,p),d=t.mul(d,y),l=t.add(l,d),p=t.mul(s,a),p=t.add(p,p),d=t.mul(p,y),c=t.sub(c,d),u=t.mul(p,f),u=t.add(u,u),u=t.add(u,u),new h(c,l,u)}add(n){u(n);const{px:r,py:i,pz:o}=this,{px:s,py:a,pz:c}=n;let l=t.ZERO,d=t.ZERO,f=t.ZERO;const p=e.a,y=t.mul(e.b,Un);let g=t.mul(r,s),w=t.mul(i,a),b=t.mul(o,c),m=t.add(r,i),v=t.add(s,a);m=t.mul(m,v),v=t.add(g,w),m=t.sub(m,v),v=t.add(r,o);let E=t.add(s,c);return v=t.mul(v,E),E=t.add(g,b),v=t.sub(v,E),E=t.add(i,o),l=t.add(a,c),E=t.mul(E,l),l=t.add(w,b),E=t.sub(E,l),f=t.mul(p,v),l=t.mul(y,b),f=t.add(l,f),l=t.sub(w,f),f=t.add(w,f),d=t.mul(l,f),w=t.add(g,g),w=t.add(w,g),b=t.mul(p,b),v=t.mul(y,v),w=t.add(w,b),b=t.sub(g,b),b=t.mul(p,b),v=t.add(v,b),g=t.mul(w,v),d=t.add(d,g),g=t.mul(E,v),l=t.mul(m,l),l=t.sub(l,g),g=t.mul(m,w),f=t.mul(E,f),f=t.add(f,g),new h(l,d,f)}subtract(n){return this.add(n.negate())}is0(){return this.equals(h.ZERO)}wNAF(n){return f.wNAFCached(this,l,n,(n=>{const e=t.invertBatch(n.map((n=>n.pz)));return n.map(((n,t)=>n.toAffine(e[t]))).map(h.fromAffine)}))}multiplyUnsafe(n){const r=h.ZERO;if(n===Sn)return r;if(a(n),n===In)return this;const{endo:i}=e;if(!i)return f.unsafeLadder(this,n);let{k1neg:o,k1:s,k2neg:c,k2:l}=i.splitScalar(n),u=r,d=r,p=this;for(;s>Sn||l>Sn;)s&In&&(u=u.add(p)),l&In&&(d=d.add(p)),p=p.double(),s>>=In,l>>=In;return o&&(u=u.negate()),c&&(d=d.negate()),d=new h(t.mul(d.px,i.beta),d.py,d.pz),u.add(d)}multiply(n){a(n);let r,i,o=n;const{endo:s}=e;if(s){const{k1neg:n,k1:e,k2neg:a,k2:c}=s.splitScalar(o);let{p:l,f:u}=this.wNAF(e),{p:d,f:p}=this.wNAF(c);l=f.constTimeNegate(n,l),d=f.constTimeNegate(a,d),d=new h(t.mul(d.px,s.beta),d.py,d.pz),r=l.add(d),i=u.add(p)}else{const{p:n,f:e}=this.wNAF(o);r=n,i=e}return h.normalizeZ([r,i])[0]}multiplyAndAddUnsafe(n,e,t){const r=h.BASE,i=(n,e)=>e!==Sn&&e!==In&&n.equals(r)?n.multiply(e):n.multiplyUnsafe(e),o=i(this,e).add(i(n,t));return o.is0()?void 0:o}toAffine(n){const{px:e,py:r,pz:i}=this,o=this.is0();null==n&&(n=o?t.ONE:t.inv(i));const s=t.mul(e,n),a=t.mul(r,n),c=t.mul(i,n);if(o)return{x:t.ZERO,y:t.ZERO};if(!t.eql(c,t.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:n,isTorsionFree:t}=e;if(n===In)return!0;if(t)return t(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:n,clearCofactor:t}=e;return n===In?this:t?t(h,this):this.multiplyUnsafe(e.h)}toRawBytes(n=!0){return this.assertValidity(),r(h,this,n)}toHex(n=!0){return N(this.toRawBytes(n))}}h.BASE=new h(e.Gx,e.Gy,t.ONE),h.ZERO=new h(t.ZERO,t.ONE,t.ZERO);const d=e.nBitLength,f=function(n,e){const t=(n,e)=>{const t=e.negate();return n?t:e},r=n=>({windows:Math.ceil(e/n)+1,windowSize:2**(n-1)});return{constTimeNegate:t,unsafeLadder(e,t){let r=n.ZERO,i=e;for(;t>vn;)t&En&&(r=r.add(i)),i=i.double(),t>>=En;return r},precomputeWindow(n,e){const{windows:t,windowSize:i}=r(e),o=[];let s=n,a=s;for(let n=0;n<t;n++){a=s,o.push(a);for(let n=1;n<i;n++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(e,i,o){const{windows:s,windowSize:a}=r(e);let c=n.ZERO,l=n.BASE;const u=BigInt(2**e-1),h=2**e,d=BigInt(e);for(let n=0;n<s;n++){const e=n*a;let r=Number(o&u);o>>=d,r>a&&(r-=h,o+=En);const s=e,f=e+Math.abs(r)-1,p=n%2!=0,y=r<0;0===r?l=l.add(t(p,i[s])):c=c.add(t(y,i[f]))}return{p:c,f:l}},wNAFCached(n,e,t,r){const i=n._WINDOW_SIZE||1;let o=e.get(n);return o||(o=this.precomputeWindow(n,i),1!==i&&e.set(n,r(o))),this.wNAF(i,o,t)}}}(h,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:s}}function On(n){const e=function(n){const e=xn(n);return on(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(n),{Fp:t,n:r}=e,i=t.BYTES+1,o=2*t.BYTES+1;function s(n){return fn(n,r)}function a(n){return gn(n,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:h}=Ln({...e,toBytes(n,e,r){const i=e.toAffine(),o=t.toBytes(i.x),s=Z;return r?s(Uint8Array.from([e.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,t.toBytes(i.y))},fromBytes(n){const e=n.length,r=n[0],s=n.subarray(1);if(e!==i||2!==r&&3!==r){if(e===o&&4===r){return{x:t.fromBytes(s.subarray(0,t.BYTES)),y:t.fromBytes(s.subarray(t.BYTES,2*t.BYTES))}}throw new Error(`Point of length ${e} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}{const n=z(s);if(!(Sn<(a=n)&&a<t.ORDER))throw new Error("Point is not on curve");const e=u(n);let i=t.sqrt(e);return!(1&~r)!==((i&In)===In)&&(i=t.neg(i)),{x:n,y:i}}var a}}),d=n=>N(F(n,e.nByteLength));function f(n){return n>r>>In}const p=(n,e,t)=>z(n.slice(e,t));class y{constructor(n,e,t){this.r=n,this.s=e,this.recovery=t,this.assertValidity()}static fromCompact(n){const t=e.nByteLength;return n=M("compactSignature",n,2*t),new y(p(n,0,t),p(n,t,2*t))}static fromDER(n){const{r:e,s:t}=Bn.toSig(M("DER",n));return new y(e,t)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(n){return new y(this.r,this.s,n)}recoverPublicKey(n){const{r:r,s:i,recovery:o}=this,l=m(M("msgHash",n));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const u=2===o||3===o?r+e.n:r;if(u>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=1&o?"03":"02",f=c.fromHex(h+d(u)),p=a(u),y=s(-l*p),g=s(i*p),w=c.BASE.multiplyAndAddUnsafe(f,y,g);if(!w)throw new Error("point at infinify");return w.assertValidity(),w}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return q(this.toDERHex())}toDERHex(){return Bn.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return q(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const g={isValidPrivateKey(n){try{return l(n),!0}catch(n){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>F(function(n,e,t=!1){const r=(n=M("privateHash",n)).length,i=mn(e).nByteLength+8;if(i<24||r<i||r>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${r}`);return fn(t?P(n):z(n),e-an)+an}(e.randomBytes(t.BYTES+8),r),e.nByteLength),precompute:(n=8,e=c.BASE)=>(e._setWindowSize(n),e.multiply(BigInt(3)),e)};function w(n){const e=n instanceof Uint8Array,t="string"==typeof n,r=(e||t)&&n.length;return e?r===i||r===o:t?r===2*i||r===2*o:n instanceof c}const b=e.bits2int||function(n){const t=z(n),r=8*n.length-e.nBitLength;return r>0?t>>BigInt(r):t},m=e.bits2int_modN||function(n){return s(b(n))},v=X(e.nBitLength);function E(n){if("bigint"!=typeof n)throw new Error("bigint expected");if(!(Sn<=n&&n<v))throw new Error(`bigint expected < 2^${e.nBitLength}`);return F(n,e.nByteLength)}function x(n,r,i=k){if(["recovered","canonical"].some((n=>n in i)))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:u}=e;let{lowS:d,prehash:p,extraEntropy:g}=i;null==d&&(d=!0),n=M("msgHash",n),p&&(n=M("prehashed msgHash",o(n)));const w=m(n),v=l(r),x=[E(v),E(w)];if(null!=g){const n=!0===g?u(t.BYTES):g;x.push(M("extraEntropy",n,t.BYTES))}const A=Z(...x),B=w;return{seed:A,k2sig:function(n){const e=b(n);if(!h(e))return;const t=a(e),r=c.BASE.multiply(e).toAffine(),i=s(r.x);if(i===Sn)return;const o=s(t*s(B+i*v));if(o===Sn)return;let l=(r.x===i?0:2)|Number(r.y&In),u=o;return d&&f(o)&&(u=function(n){return f(n)?s(-n):n}(o),l^=1),new y(i,u,l)}}}const k={lowS:e.lowS,prehash:!1},A={lowS:e.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(n,e=!0){return c.fromPrivateKey(n).toRawBytes(e)},getSharedSecret:function(n,e,t=!0){if(w(n))throw new Error("first arg must be private key");if(!w(e))throw new Error("second arg must be public key");return c.fromHex(e).multiply(l(n)).toRawBytes(t)},sign:function(n,t,r=k){const{seed:i,k2sig:o}=x(n,t,r),s=e;return tn(s.hash.outputLen,s.nByteLength,s.hmac)(i,o)},verify:function(n,t,r,i=A){const o=n;if(t=M("msgHash",t),r=M("publicKey",r),"strict"in i)throw new Error("options.strict was renamed to lowS");const{lowS:l,prehash:u}=i;let h,d;try{if("string"==typeof o||o instanceof Uint8Array)try{h=y.fromDER(o)}catch(n){if(!(n instanceof Bn.Err))throw n;h=y.fromCompact(o)}else{if("object"!=typeof o||"bigint"!=typeof o.r||"bigint"!=typeof o.s)throw new Error("PARSE");{const{r:n,s:e}=o;h=new y(n,e)}}d=c.fromHex(r)}catch(n){if("PARSE"===n.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(l&&h.hasHighS())return!1;u&&(t=e.hash(t));const{r:f,s:p}=h,g=m(t),w=a(p),b=s(g*w),v=s(f*w),E=c.BASE.multiplyAndAddUnsafe(d,b,v)?.toAffine();return!!E&&s(E.x)===f},ProjectivePoint:c,Signature:y,utils:g}}var _n=class extends m{constructor(n,e){super(),this.finished=!1,this.destroyed=!1,c.hash(n);const t=w(e);if(this.iHash=n.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(t.length>r?n.create().update(t).digest():t);for(let n=0;n<i.length;n++)i[n]^=54;this.iHash.update(i),this.oHash=n.create();for(let n=0;n<i.length;n++)i[n]^=106;this.oHash.update(i),i.fill(0)}update(n){return c.exists(this),this.iHash.update(n),this}digestInto(n){c.exists(this),c.bytes(n,this.outputLen),this.finished=!0,this.iHash.digestInto(n),this.oHash.update(n),this.oHash.digestInto(n),this.destroy()}digest(){const n=new Uint8Array(this.oHash.outputLen);return this.digestInto(n),n}_cloneInto(n){n||(n=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:t,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return n.finished=r,n.destroyed=i,n.blockLen=o,n.outputLen=s,n.oHash=e._cloneInto(n.oHash),n.iHash=t._cloneInto(n.iHash),n}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Tn=(n,e,t)=>new _n(n,e).update(t).digest();function Cn(n){return{hash:n,hmac:(e,...t)=>Tn(n,e,b(...t)),randomBytes:x}}Tn.create=(n,e)=>new _n(n,e);var Hn=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Rn=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),$n=BigInt(1),Nn=BigInt(2),Kn=(n,e)=>(n+e/Nn)/e;function jn(n){const e=Hn,t=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),l=n*n*n%e,u=l*l*n%e,h=yn(u,t,e)*u%e,d=yn(h,t,e)*u%e,f=yn(d,Nn,e)*l%e,p=yn(f,i,e)*f%e,y=yn(p,o,e)*p%e,g=yn(y,a,e)*y%e,w=yn(g,c,e)*g%e,b=yn(w,a,e)*y%e,m=yn(b,t,e)*u%e,v=yn(m,s,e)*p%e,E=yn(v,r,e)*l%e,x=yn(E,Nn,e);if(!qn.eql(qn.sqr(x),n))throw new Error("Cannot find square root");return x}var qn=function(n,e,t=!1,r={}){if(n<=sn)throw new Error(`Expected Fp ORDER > 0, got ${n}`);const{nBitLength:i,nByteLength:o}=mn(n,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=wn(n),a=Object.freeze({ORDER:n,BITS:i,BYTES:o,MASK:X(i),ZERO:sn,ONE:an,create:e=>fn(e,n),isValid:e=>{if("bigint"!=typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return sn<=e&&e<n},is0:n=>n===sn,isOdd:n=>(n&an)===an,neg:e=>fn(-e,n),eql:(n,e)=>n===e,sqr:e=>fn(e*e,n),add:(e,t)=>fn(e+t,n),sub:(e,t)=>fn(e-t,n),mul:(e,t)=>fn(e*t,n),pow:(n,e)=>function(n,e,t){if(t<sn)throw new Error("Expected power > 0");if(t===sn)return n.ONE;if(t===an)return e;let r=n.ONE,i=e;for(;t>sn;)t&an&&(r=n.mul(r,i)),i=n.sqr(i),t>>=an;return r}(a,n,e),div:(e,t)=>fn(e*gn(t,n),n),sqrN:n=>n*n,addN:(n,e)=>n+e,subN:(n,e)=>n-e,mulN:(n,e)=>n*e,inv:e=>gn(e,n),sqrt:r.sqrt||(n=>s(a,n)),invertBatch:n=>function(n,e){const t=new Array(e.length),r=e.reduce(((e,r,i)=>n.is0(r)?e:(t[i]=e,n.mul(e,r))),n.ONE),i=n.inv(r);return e.reduceRight(((e,r,i)=>n.is0(r)?e:(t[i]=n.mul(e,t[i]),n.mul(e,r))),i),t}(a,n),cmov:(n,e,t)=>t?e:n,toBytes:n=>t?D(n,o):F(n,o),fromBytes:n=>{if(n.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${n.length}`);return t?P(n):z(n)}});return Object.freeze(a)}(Hn,void 0,void 0,{sqrt:jn}),zn=function(n,e){const t=e=>On({...n,...Cn(e)});return Object.freeze({...t(e),create:t})}({a:BigInt(0),b:BigInt(7),Fp:qn,n:Rn,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const e=Rn,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-$n*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=t,s=BigInt("0x100000000000000000000000000000000"),a=Kn(o*n,e),c=Kn(-r*n,e);let l=fn(n-a*t-c*i,e),u=fn(-a*r-c*o,e);const h=l>s,d=u>s;if(h&&(l=e-l),d&&(u=e-u),l>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:h,k1:l,k2neg:d,k2:u}}}},O),Pn=BigInt(0),Fn=n=>"bigint"==typeof n&&Pn<n&&n<Hn,Dn={};function Vn(n,...e){let t=Dn[n];if(void 0===t){const e=O(Uint8Array.from(n,(n=>n.charCodeAt(0))));t=Z(e,e),Dn[n]=t}return O(Z(t,...e))}var Mn=n=>n.toRawBytes(!0).slice(1),Zn=n=>F(n,32),Gn=n=>fn(n,Hn),Wn=n=>fn(n,Rn),Jn=zn.ProjectivePoint;function Yn(n){let e=zn.utils.normPrivateKeyToScalar(n),t=Jn.fromPrivateKey(e);return{scalar:t.hasEvenY()?e:Wn(-e),bytes:Mn(t)}}function Qn(n){if(!Fn(n))throw new Error("bad x: need 0 < x < p");const e=Gn(n*n);let t=jn(Gn(e*n+BigInt(7)));t%Nn!==Pn&&(t=Gn(-t));const r=new Jn(n,t,$n);return r.assertValidity(),r}function Xn(...n){return Wn(z(Vn("BIP0340/challenge",...n)))}function ne(n){return Yn(n).bytes}function ee(n,e,t=x(32)){const r=M("message",n),{bytes:i,scalar:o}=Yn(e),s=M("auxRand",t,32),a=Zn(o^z(Vn("BIP0340/aux",s))),c=Vn("BIP0340/nonce",a,i,r),l=Wn(z(c));if(l===Pn)throw new Error("sign failed: k is zero");const{bytes:u,scalar:h}=Yn(l),d=Xn(u,i,r),f=new Uint8Array(64);if(f.set(u,0),f.set(Zn(Wn(h+d*o)),32),!te(f,r,i))throw new Error("sign: Invalid signature produced");return f}function te(n,e,t){const r=M("signature",n,64),i=M("message",e),o=M("publicKey",t,32);try{const n=Qn(z(o)),e=z(r.subarray(0,32));if(!Fn(e))return!1;const t=z(r.subarray(32,64));if(!("bigint"==typeof(l=t)&&Pn<l&&l<Rn))return!1;const u=Xn(Zn(e),Mn(n),i),h=(s=n,a=t,c=Wn(-u),Jn.BASE.multiplyAndAddUnsafe(s,a,c));return!(!h||!h.hasEvenY()||h.toAffine().x!==e)}catch(n){return!1}var s,a,c,l}var re=(()=>({getPublicKey:ne,sign:ee,verify:te,utils:{randomPrivateKey:zn.utils.randomPrivateKey,lift_x:Qn,pointToBytes:Mn,numberToBytesBE:F,bytesToNumberBE:z,taggedHash:Vn,mod:fn}}))();function ie(){return p(re.utils.randomPrivateKey())}function oe(n){return p(re.getPublicKey(n))}var se={};i(se,{MessageNode:()=>de,MessageQueue:()=>fe,insertEventIntoAscendingList:()=>he,insertEventIntoDescendingList:()=>ue,normalizeURL:()=>le,utf8Decoder:()=>ae,utf8Encoder:()=>ce});var ae=new TextDecoder("utf-8"),ce=new TextEncoder;function le(n){let e=new URL(n);return e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),("80"===e.port&&"ws:"===e.protocol||"443"===e.port&&"wss:"===e.protocol)&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}function ue(n,e){let t,r=0,i=n.length-1,o=r;if(i<0)o=0;else if(e.created_at<n[i].created_at)o=i+1;else if(e.created_at>=n[r].created_at)o=r;else for(;;){if(i<=r+1){o=i;break}if(t=Math.floor(r+(i-r)/2),n[t].created_at>e.created_at)r=t;else{if(!(n[t].created_at<e.created_at)){o=t;break}i=t}}return n[o]?.id!==e.id?[...n.slice(0,o),e,...n.slice(o)]:n}function he(n,e){let t,r=0,i=n.length-1,o=r;if(i<0)o=0;else if(e.created_at>n[i].created_at)o=i+1;else if(e.created_at<=n[r].created_at)o=r;else for(;;){if(i<=r+1){o=i;break}if(t=Math.floor(r+(i-r)/2),n[t].created_at<e.created_at)r=t;else{if(!(n[t].created_at>e.created_at)){o=t;break}i=t}}return n[o]?.id!==e.id?[...n.slice(0,o),e,...n.slice(o)]:n}var de=class{_value;_next;get value(){return this._value}set value(n){this._value=n}get next(){return this._next}set next(n){this._next=n}constructor(n){this._value=n,this._next=null}},fe=class{_first;_last;get first(){return this._first}set first(n){this._first=n}get last(){return this._last}set last(n){this._last=n}_size;get size(){return this._size}set size(n){this._size=n}constructor(){this._first=null,this._last=null,this._size=0}enqueue(n){const e=new de(n);return 0!==this._size&&this._last?(this._last.next=e,this._last=e):(this._first=e,this._last=e),this._size++,!0}dequeue(){if(0===this._size||!this._first)return null;let n=this._first;return this._first=n.next,n.next=null,this._size--,n.value}},pe=Symbol("verified"),ye=(n=>(n[n.Metadata=0]="Metadata",n[n.Text=1]="Text",n[n.RecommendRelay=2]="RecommendRelay",n[n.Contacts=3]="Contacts",n[n.EncryptedDirectMessage=4]="EncryptedDirectMessage",n[n.EventDeletion=5]="EventDeletion",n[n.Repost=6]="Repost",n[n.Reaction=7]="Reaction",n[n.BadgeAward=8]="BadgeAward",n[n.ChannelCreation=40]="ChannelCreation",n[n.ChannelMetadata=41]="ChannelMetadata",n[n.ChannelMessage=42]="ChannelMessage",n[n.ChannelHideMessage=43]="ChannelHideMessage",n[n.ChannelMuteUser=44]="ChannelMuteUser",n[n.Blank=255]="Blank",n[n.Report=1984]="Report",n[n.ZapRequest=9734]="ZapRequest",n[n.Zap=9735]="Zap",n[n.RelayList=10002]="RelayList",n[n.ClientAuth=22242]="ClientAuth",n[n.HttpAuth=27235]="HttpAuth",n[n.ProfileBadge=30008]="ProfileBadge",n[n.BadgeDefinition=30009]="BadgeDefinition",n[n.Article=30023]="Article",n[n.FileMetadata=1063]="FileMetadata",n))(ye||{});function ge(n=255){return{kind:n,content:"",tags:[],created_at:0}}function we(n,e){const t=n;return t.pubkey=oe(e),t.id=me(t),t.sig=Ae(t,e),t[pe]=!0,t}function be(n){if(!Ee(n))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,n.pubkey,n.created_at,n.kind,n.tags,n.content])}function me(n){return p(O(ce.encode(be(n))))}var ve=n=>n instanceof Object;function Ee(n){if(!ve(n))return!1;if("number"!=typeof n.kind)return!1;if("string"!=typeof n.content)return!1;if("number"!=typeof n.created_at)return!1;if("string"!=typeof n.pubkey)return!1;if(!n.pubkey.match(/^[a-f0-9]{64}$/))return!1;if(!Array.isArray(n.tags))return!1;for(let e=0;e<n.tags.length;e++){let t=n.tags[e];if(!Array.isArray(t))return!1;for(let n=0;n<t.length;n++)if("object"==typeof t[n])return!1}return!0}function xe(n){if("boolean"==typeof n[pe])return n[pe];const e=me(n);if(e!==n.id)return n[pe]=!1;try{return n[pe]=re.verify(n.sig,e,n.pubkey)}catch(e){return n[pe]=!1}}function ke(n,e){return console.warn("nostr-tools: `signEvent` is deprecated and will be removed or changed in the future. Please use `getSignature` instead."),Ae(n,e)}function Ae(n,e){return p(re.sign(me(n),e))}function Be(n,e){if(n.ids&&-1===n.ids.indexOf(e.id)&&!n.ids.some((n=>e.id.startsWith(n))))return!1;if(n.kinds&&-1===n.kinds.indexOf(e.kind))return!1;if(n.authors&&-1===n.authors.indexOf(e.pubkey)&&!n.authors.some((n=>e.pubkey.startsWith(n))))return!1;for(let t in n)if("#"===t[0]){let r=n[`#${t.slice(1)}`];if(r&&!e.tags.find((([n,e])=>n===t.slice(1)&&-1!==r.indexOf(e))))return!1}return!(n.since&&e.created_at<n.since)&&!(n.until&&e.created_at>n.until)}function Se(n,e){for(let t=0;t<n.length;t++)if(Be(n[t],e))return!0;return!1}function Ie(...n){let e={};for(let t=0;t<n.length;t++){let r=n[t];Object.entries(r).forEach((([n,t])=>{if("kinds"===n||"ids"===n||"authors"===n||"#"===n[0]){e[n]=e[n]||[];for(let r=0;r<t.length;r++){let i=t[r];e[n].includes(i)||e[n].push(i)}}})),r.limit&&(!e.limit||r.limit>e.limit)&&(e.limit=r.limit),r.until&&(!e.until||r.until>e.until)&&(e.until=r.until),r.since&&(!e.since||r.since<e.since)&&(e.since=r.since)}return e}var Ue={};function Le(n,e){let t=e.length+3,r=n.indexOf(`"${e}":`)+t,i=n.slice(r).indexOf('"')+r+1;return n.slice(i,i+64)}function Oe(n,e){let t=e.length,r=n.indexOf(`"${e}":`)+t+3,i=n.slice(r),o=Math.min(i.indexOf(","),i.indexOf("}"));return parseInt(i.slice(0,o),10)}function _e(n){let e=n.slice(0,22).indexOf('"EVENT"');if(-1===e)return null;let t=n.slice(e+7+1).indexOf('"');if(-1===t)return null;let r=e+7+1+t,i=n.slice(r+1,80).indexOf('"');if(-1===i)return null;let o=r+1+i;return n.slice(r+1,o)}function Te(n,e){return e===Le(n,"id")}function Ce(n,e){return e===Le(n,"pubkey")}function He(n,e){return e===Oe(n,"kind")}i(Ue,{getHex64:()=>Le,getInt:()=>Oe,getSubscriptionId:()=>_e,matchEventId:()=>Te,matchEventKind:()=>He,matchEventPubkey:()=>Ce});var Re=()=>({connect:[],disconnect:[],error:[],notice:[],auth:[]});function $e(n,e={}){let{listTimeout:t=3e3,getTimeout:r=3e3,countTimeout:i=3e3}=e;var o,s,a={},c=Re(),l={},u={};function h(){return 1===o?.readyState}async function d(n){let e=JSON.stringify(n);if(h()||(await new Promise((n=>setTimeout(n,1e3))),h()))try{o.send(e)}catch(n){console.log(n)}}const f=(n,{verb:e="REQ",skipVerification:t=!1,alreadyHaveEvent:r=null,id:i=Math.random().toString().slice(2)}={})=>{let o=i;a[o]={id:o,filters:n,skipVerification:t,alreadyHaveEvent:r},d([e,o,...n]);let s={sub:(e,i={})=>f(e||n,{skipVerification:i.skipVerification||t,alreadyHaveEvent:i.alreadyHaveEvent||r,id:o}),unsub:()=>{delete a[o],delete l[o],d(["CLOSE",o])},on:(n,e)=>{l[o]=l[o]||{event:[],count:[],eose:[]},l[o][n].push(e)},off:(n,e)=>{let t=l[o],r=t[n].indexOf(e);r>=0&&t[n].splice(r,1)},get events(){return Ne(s)}};return s};function p(n,e){return new Promise(((t,r)=>{if(!n.id)return void r(new Error(`event ${n} has no id`));let i=n.id;d([e,n]),u[i]={resolve:t,reject:r}}))}return{url:n,sub:f,on:(n,e)=>{c[n].push(e),"connect"===n&&1===o?.readyState&&e()},off:(n,e)=>{let t=c[n].indexOf(e);-1!==t&&c[n].splice(t,1)},list:(n,e)=>new Promise((r=>{let i=f(n,e),o=[],s=setTimeout((()=>{i.unsub(),r(o)}),t);i.on("eose",(()=>{i.unsub(),clearTimeout(s),r(o)})),i.on("event",(n=>{o.push(n)}))})),get:(n,e)=>new Promise((t=>{let i=f([n],e),o=setTimeout((()=>{i.unsub(),t(null)}),r);i.on("event",(n=>{i.unsub(),clearTimeout(o),t(n)}))})),count:n=>new Promise((e=>{let t=f(n,{...f,verb:"COUNT"}),r=setTimeout((()=>{t.unsub(),e(null)}),i);t.on("count",(n=>{t.unsub(),clearTimeout(r),e(n)}))})),async publish(n){await p(n,"EVENT")},async auth(n){await p(n,"AUTH")},connect:async function(){h()||await async function(){return s||(s=new Promise(((e,t)=>{try{o=new WebSocket(n)}catch(n){t(n)}o.onopen=()=>{c.connect.forEach((n=>n())),e()},o.onerror=()=>{s=void 0,c.error.forEach((n=>n())),t()},o.onclose=async()=>{s=void 0,c.disconnect.forEach((n=>n()))};let r,i=new fe;function h(){if(0===i.size)return clearInterval(r),void(r=null);var e=i.dequeue();if(!e)return;let t=_e(e);if(t){let r=a[t];if(r&&r.alreadyHaveEvent&&r.alreadyHaveEvent(Le(e,"id"),n))return}try{let n=JSON.parse(e);switch(n[0]){case"EVENT":{let e=n[1],t=n[2];return void(Ee(t)&&a[e]&&(a[e].skipVerification||xe(t))&&Se(a[e].filters,t)&&(a[e],(l[e]?.event||[]).forEach((n=>n(t)))))}case"COUNT":let e=n[1],t=n[2];return void(a[e]&&(l[e]?.count||[]).forEach((n=>n(t))));case"EOSE":{let e=n[1];return void(e in l&&(l[e].eose.forEach((n=>n())),l[e].eose=[]))}case"OK":{let e=n[1],t=n[2],r=n[3]||"";if(e in u){let{resolve:n,reject:i}=u[e];t?n(null):i(new Error(r))}return}case"NOTICE":let r=n[1];return void c.notice.forEach((n=>n(r)));case"AUTH":{let e=n[1];return void c.auth?.forEach((n=>n(e)))}}}catch(n){return}}o.onmessage=n=>{i.enqueue(n.data),r||(r=setInterval(h,0))}})))}()},close(){c=Re(),l={},u={},o?.readyState===WebSocket.OPEN&&o.close()},get status(){return o?.readyState??3}}}async function*Ne(n){let e;const t=[],r=n=>{e?(e(n),e=void 0):t.push(n)};n.on("event",r);try{for(;;)if(t.length>0)yield t.shift();else{const n=await new Promise((n=>{e=n}));yield n}}finally{n.off("event",r)}}var Ke=class{_conn;_seenOn={};batchedByKey={};eoseSubTimeout;getTimeout;seenOnEnabled=!0;batchInterval=100;constructor(n={}){this._conn={},this.eoseSubTimeout=n.eoseSubTimeout||3400,this.getTimeout=n.getTimeout||3400,this.seenOnEnabled=!1!==n.seenOnEnabled,this.batchInterval=n.batchInterval||100}close(n){n.forEach((n=>{let e=this._conn[le(n)];e&&e.close()}))}async ensureRelay(n){const e=le(n);this._conn[e]||(this._conn[e]=$e(e,{getTimeout:.9*this.getTimeout,listTimeout:.9*this.getTimeout}));const t=this._conn[e];return await t.connect(),t}sub(n,e,t){let r=new Set,i={...t||{}};i.alreadyHaveEvent=(n,e)=>{if(t?.alreadyHaveEvent?.(n,e))return!0;if(this.seenOnEnabled){let t=this._seenOn[n]||new Set;t.add(e),this._seenOn[n]=t}return r.has(n)};let o=[],s=new Set,a=new Set,c=n.length,l=!1,u=setTimeout((()=>{l=!0;for(let n of a.values())n()}),t?.eoseSubTimeout||this.eoseSubTimeout);n.filter(((n,e,t)=>t.indexOf(n)===e)).forEach((async n=>{let t;try{t=await this.ensureRelay(n)}catch(n){return void d()}if(!t)return;let h=t.sub(e,i);function d(){if(c--,0===c){clearTimeout(u);for(let n of a.values())n()}}h.on("event",(n=>{r.add(n.id);for(let e of s.values())e(n)})),h.on("eose",(()=>{l||d()})),o.push(h)}));let h={sub:(n,e)=>(o.forEach((t=>t.sub(n,e))),h),unsub(){o.forEach((n=>n.unsub()))},on(n,e){"event"===n?s.add(e):"eose"===n&&a.add(e)},off(n,e){"event"===n?s.delete(e):"eose"===n&&a.delete(e)},get events(){return Ne(h)}};return h}get(n,e,t){return new Promise((r=>{let i=this.sub(n,[e],t),o=setTimeout((()=>{i.unsub(),r(null)}),this.getTimeout);i.on("event",(n=>{r(n),clearTimeout(o),i.unsub()}))}))}list(n,e,t){return new Promise((r=>{let i=[],o=this.sub(n,e,t);o.on("event",(n=>{i.push(n)})),o.on("eose",(()=>{o.unsub(),r(i)}))}))}batchedList(n,e,t){return new Promise((r=>{this.batchedByKey[n]?this.batchedByKey[n].push({filters:t,relays:e,resolve:r,events:[]}):(this.batchedByKey[n]=[{filters:t,relays:e,resolve:r,events:[]}],setTimeout((()=>{Object.keys(this.batchedByKey).forEach((async n=>{const e=this.batchedByKey[n],t=[],r=[];e.forEach((n=>{t.push(...n.filters),r.push(...n.relays)}));const i=this.sub(r,t);i.on("event",(n=>{e.forEach((e=>Se(e.filters,n)&&e.events.push(n)))})),i.on("eose",(()=>{i.unsub(),e.forEach((n=>n.resolve(n.events)))})),delete this.batchedByKey[n]}))}),this.batchInterval))}))}publish(n,e){return n.map((async n=>(await this.ensureRelay(n)).publish(e)))}seenOn(n){return Array.from(this._seenOn[n]?.values?.()||[])}},je={};function qe(n){if(!Number.isSafeInteger(n))throw new Error(`Wrong integer: ${n}`)}function ze(...n){const e=(n,e)=>t=>n(e(t));return{encode:Array.from(n).reverse().reduce(((n,t)=>n?e(n,t.encode):t.encode),void 0),decode:n.reduce(((n,t)=>n?e(n,t.decode):t.decode),void 0)}}function Pe(n){return{encode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("alphabet.encode input should be an array of numbers");return e.map((e=>{if(qe(e),e<0||e>=n.length)throw new Error(`Digit index outside alphabet: ${e} (alphabet: ${n.length})`);return n[e]}))},decode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("alphabet.decode input should be array of strings");return e.map((e=>{if("string"!=typeof e)throw new Error(`alphabet.decode: not string element=${e}`);const t=n.indexOf(e);if(-1===t)throw new Error(`Unknown letter: "${e}". Allowed: ${n}`);return t}))}}}function Fe(n=""){if("string"!=typeof n)throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("join.encode input should be array of strings");for(let n of e)if("string"!=typeof n)throw new Error(`join.encode: non-string input=${n}`);return e.join(n)},decode:e=>{if("string"!=typeof e)throw new Error("join.decode input should be string");return e.split(n)}}}function De(n,e="="){if(qe(n),"string"!=typeof e)throw new Error("padding chr should be string");return{encode(t){if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("padding.encode input should be array of strings");for(let n of t)if("string"!=typeof n)throw new Error(`padding.encode: non-string input=${n}`);for(;t.length*n%8;)t.push(e);return t},decode(t){if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("padding.encode input should be array of strings");for(let n of t)if("string"!=typeof n)throw new Error(`padding.decode: non-string input=${n}`);let r=t.length;if(r*n%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&t[r-1]===e;r--)if(!((r-1)*n%8))throw new Error("Invalid padding: string has too much padding");return t.slice(0,r)}}}function Ve(n){if("function"!=typeof n)throw new Error("normalize fn should be function");return{encode:n=>n,decode:e=>n(e)}}function Me(n,e,t){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(t<2)throw new Error(`convertRadix: wrong to=${t}, base cannot be less than 2`);if(!Array.isArray(n))throw new Error("convertRadix: data should be array");if(!n.length)return[];let r=0;const i=[],o=Array.from(n);for(o.forEach((n=>{if(qe(n),n<0||n>=e)throw new Error(`Wrong integer: ${n}`)}));;){let n=0,s=!0;for(let i=r;i<o.length;i++){const a=o[i],c=e*n+a;if(!Number.isSafeInteger(c)||e*n/e!==n||c-a!=e*n)throw new Error("convertRadix: carry overflow");if(n=c%t,o[i]=Math.floor(c/t),!Number.isSafeInteger(o[i])||o[i]*t+n!==c)throw new Error("convertRadix: carry overflow");s&&(o[i]?s=!1:r=i)}if(i.push(n),s)break}for(let e=0;e<n.length-1&&0===n[e];e++)i.push(0);return i.reverse()}i(je,{BECH32_REGEX:()=>wt,decode:()=>bt,naddrEncode:()=>It,neventEncode:()=>St,noteEncode:()=>xt,nprofileEncode:()=>Bt,npubEncode:()=>Et,nrelayEncode:()=>Ut,nsecEncode:()=>vt});var Ze=(n,e)=>e?Ze(e,n%e):n,Ge=(n,e)=>n+(e-Ze(n,e));function We(n,e,t,r){if(!Array.isArray(n))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(t<=0||t>32)throw new Error(`convertRadix2: wrong to=${t}`);if(Ge(e,t)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${t} carryBits=${Ge(e,t)}`);let i=0,o=0;const s=2**t-1,a=[];for(const r of n){if(qe(r),r>=2**e)throw new Error(`convertRadix2: invalid data word=${r} from=${e}`);if(i=i<<e|r,o+e>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${e}`);for(o+=e;o>=t;o-=t)a.push((i>>o-t&s)>>>0);i&=2**o-1}if(i=i<<t-o&s,!r&&o>=e)throw new Error("Excess padding");if(!r&&i)throw new Error(`Non-zero padding: ${i}`);return r&&o>0&&a.push(i>>>0),a}function Je(n){return qe(n),{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Me(Array.from(e),256,n)},decode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Me(e,n,256))}}}function Ye(n,e=!1){if(qe(n),n<=0||n>32)throw new Error("radix2: bits should be in (0..32]");if(Ge(8,n)>32||Ge(n,8)>32)throw new Error("radix2: carry overflow");return{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return We(Array.from(t),8,n,!e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(We(t,n,8,e))}}}function Qe(n){if("function"!=typeof n)throw new Error("unsafeWrapper fn should be function");return function(...e){try{return n.apply(null,e)}catch(n){}}}function Xe(n,e){if(qe(n),"function"!=typeof e)throw new Error("checksum fn should be function");return{encode(t){if(!(t instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const r=e(t).slice(0,n),i=new Uint8Array(t.length+n);return i.set(t),i.set(r,t.length),i},decode(t){if(!(t instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const r=t.slice(0,-n),i=e(r).slice(0,n),o=t.slice(-n);for(let e=0;e<n;e++)if(i[e]!==o[e])throw new Error("Invalid checksum");return r}}}var nt={alphabet:Pe,chain:ze,checksum:Xe,radix:Je,radix2:Ye,join:Fe,padding:De},et=ze(Ye(4),Pe("0123456789ABCDEF"),Fe("")),tt=ze(Ye(5),Pe("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),De(5),Fe("")),rt=(ze(Ye(5),Pe("0123456789ABCDEFGHIJKLMNOPQRSTUV"),De(5),Fe("")),ze(Ye(5),Pe("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Fe(""),Ve((n=>n.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")))),ze(Ye(6),Pe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),De(6),Fe(""))),it=ze(Ye(6),Pe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),De(6),Fe("")),ot=n=>ze(Je(58),Pe(n),Fe("")),st=ot("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),at=(ot("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),ot("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),[0,2,3,5,6,7,9,10,11]),ct={encode(n){let e="";for(let t=0;t<n.length;t+=8){const r=n.subarray(t,t+8);e+=st.encode(r).padStart(at[r.length],"1")}return e},decode(n){let e=[];for(let t=0;t<n.length;t+=11){const r=n.slice(t,t+11),i=at.indexOf(r.length),o=st.decode(r);for(let n=0;n<o.length-i;n++)if(0!==o[n])throw new Error("base58xmr: wrong padding");e=e.concat(Array.from(o.slice(o.length-i)))}return Uint8Array.from(e)}},lt=ze(Pe("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Fe("")),ut=[996825010,642813549,513874426,1027748829,705979059];function ht(n){const e=n>>25;let t=(33554431&n)<<5;for(let n=0;n<ut.length;n++)1==(e>>n&1)&&(t^=ut[n]);return t}function dt(n,e,t=1){const r=n.length;let i=1;for(let e=0;e<r;e++){const t=n.charCodeAt(e);if(t<33||t>126)throw new Error(`Invalid prefix (${n})`);i=ht(i)^t>>5}i=ht(i);for(let e=0;e<r;e++)i=ht(i)^31&n.charCodeAt(e);for(let n of e)i=ht(i)^n;for(let n=0;n<6;n++)i=ht(i);return i^=t,lt.encode(We([i%2**30],30,5,!1))}function ft(n){const e="bech32"===n?1:734539939,t=Ye(5),r=t.decode,i=t.encode,o=Qe(r);function s(n,t=90){if("string"!=typeof n)throw new Error("bech32.decode input should be string, not "+typeof n);if(n.length<8||!1!==t&&n.length>t)throw new TypeError(`Wrong string length: ${n.length} (${n}). Expected (8..${t})`);const r=n.toLowerCase();if(n!==r&&n!==n.toUpperCase())throw new Error("String must be lowercase or uppercase");const i=(n=r).lastIndexOf("1");if(0===i||-1===i)throw new Error('Letter "1" must be present between prefix and data only');const o=n.slice(0,i),s=n.slice(i+1);if(s.length<6)throw new Error("Data must be at least 6 characters long");const a=lt.decode(s).slice(0,-6),c=dt(o,a,e);if(!s.endsWith(c))throw new Error(`Invalid checksum in ${n}: expected "${c}"`);return{prefix:o,words:a}}return{encode:function(n,t,r=90){if("string"!=typeof n)throw new Error("bech32.encode prefix should be string, not "+typeof n);if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof t);const i=n.length+7+t.length;if(!1!==r&&i>r)throw new TypeError(`Length ${i} exceeds limit ${r}`);return`${n=n.toLowerCase()}1${lt.encode(t)}${dt(n,t,e)}`},decode:s,decodeToBytes:function(n){const{prefix:e,words:t}=s(n,!1);return{prefix:e,words:t,bytes:r(t)}},decodeUnsafe:Qe(s),fromWords:r,fromWordsUnsafe:o,toWords:i}}var pt=ft("bech32"),yt=(ft("bech32m"),{utf8:{encode:n=>(new TextDecoder).decode(n),decode:n=>(new TextEncoder).encode(n)},hex:ze(Ye(4),Pe("0123456789abcdef"),Fe(""),Ve((n=>{if("string"!=typeof n||n.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof n} with length ${n.length}`);return n.toLowerCase()}))),base16:et,base32:tt,base64:rt,base64url:it,base58:st,base58xmr:ct}),gt=(Object.keys(yt).join(", "),5e3),wt=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function bt(n){let{prefix:e,words:t}=pt.decode(n,gt),r=new Uint8Array(pt.fromWords(t));switch(e){case"nprofile":{let n=mt(r);if(!n[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(32!==n[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:p(n[0][0]),relays:n[1]?n[1].map((n=>ae.decode(n))):[]}}}case"nevent":{let n=mt(r);if(!n[0]?.[0])throw new Error("missing TLV 0 for nevent");if(32!==n[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(n[2]&&32!==n[2][0].length)throw new Error("TLV 2 should be 32 bytes");return{type:"nevent",data:{id:p(n[0][0]),relays:n[1]?n[1].map((n=>ae.decode(n))):[],author:n[2]?.[0]?p(n[2][0]):void 0}}}case"naddr":{let n=mt(r);if(!n[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!n[2]?.[0])throw new Error("missing TLV 2 for naddr");if(32!==n[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!n[3]?.[0])throw new Error("missing TLV 3 for naddr");if(4!==n[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:ae.decode(n[0][0]),pubkey:p(n[2][0]),kind:parseInt(p(n[3][0]),16),relays:n[1]?n[1].map((n=>ae.decode(n))):[]}}}case"nrelay":{let n=mt(r);if(!n[0]?.[0])throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:ae.decode(n[0][0])}}case"nsec":case"npub":case"note":return{type:e,data:p(r)};default:throw new Error(`unknown prefix ${e}`)}}function mt(n){let e={},t=n;for(;t.length>0;){let n=t[0],r=t[1];if(!r)throw new Error(`malformed TLV ${n}`);let i=t.slice(2,2+r);if(t=t.slice(2+r),i.length<r)throw new Error(`not enough data to read on TLV ${n}`);e[n]=e[n]||[],e[n].push(i)}return e}function vt(n){return At("nsec",n)}function Et(n){return At("npub",n)}function xt(n){return At("note",n)}function kt(n,e){let t=pt.toWords(e);return pt.encode(n,t,gt)}function At(n,e){return kt(n,y(e))}function Bt(n){return kt("nprofile",Lt({0:[y(n.pubkey)],1:(n.relays||[]).map((n=>ce.encode(n)))}))}function St(n){return kt("nevent",Lt({0:[y(n.id)],1:(n.relays||[]).map((n=>ce.encode(n))),2:n.author?[y(n.author)]:[]}))}function It(n){let e=new ArrayBuffer(4);return new DataView(e).setUint32(0,n.kind,!1),kt("naddr",Lt({0:[ce.encode(n.identifier)],1:(n.relays||[]).map((n=>ce.encode(n))),2:[y(n.pubkey)],3:[new Uint8Array(e)]}))}function Ut(n){return kt("nrelay",Lt({0:[ce.encode(n)]}))}function Lt(n){let e=[];return Object.entries(n).forEach((([n,t])=>{t.forEach((t=>{let r=new Uint8Array(t.length+2);r.set([parseInt(n)],0),r.set([t.length],1),r.set(t,2),e.push(r)}))})),b(...e)}var Ot=/\bnostr:((note|npub|naddr|nevent|nprofile)1\w+)\b|#\[(\d+)\]/g;function _t(n){let e=[];for(let t of n.content.matchAll(Ot))if(t[2])try{let{type:n,data:r}=bt(t[1]);switch(n){case"npub":e.push({text:t[0],profile:{pubkey:r,relays:[]}});break;case"nprofile":e.push({text:t[0],profile:r});break;case"note":e.push({text:t[0],event:{id:r,relays:[]}});break;case"nevent":e.push({text:t[0],event:r});break;case"naddr":e.push({text:t[0],address:r})}}catch(n){}else if(t[3]){let r=parseInt(t[3],10),i=n.tags[r];if(!i)continue;switch(i[0]){case"p":e.push({text:t[0],profile:{pubkey:i[1],relays:i[2]?[i[2]]:[]}});break;case"e":e.push({text:t[0],event:{id:i[1],relays:i[2]?[i[2]]:[]}});break;case"a":try{let[n,r,o]=i[1].split(":");e.push({text:t[0],address:{identifier:o,pubkey:r,kind:parseInt(n,10),relays:i[2]?[i[2]]:[]}})}catch(n){}}}return e}var Tt={};async function Ct(n,e,t){const r=Rt(zn.getSharedSecret(n,"02"+e));let i=Uint8Array.from(x(16)),o=ce.encode(t),s=await crypto.subtle.importKey("raw",r,{name:"AES-CBC"},!1,["encrypt"]),a=await crypto.subtle.encrypt({name:"AES-CBC",iv:i},s,o);return`${rt.encode(new Uint8Array(a))}?iv=${rt.encode(new Uint8Array(i.buffer))}`}async function Ht(n,e,t){let[r,i]=t.split("?iv="),o=Rt(zn.getSharedSecret(n,"02"+e)),s=await crypto.subtle.importKey("raw",o,{name:"AES-CBC"},!1,["decrypt"]),a=rt.decode(r),c=rt.decode(i),l=await crypto.subtle.decrypt({name:"AES-CBC",iv:c},s,a);return ae.decode(l)}function Rt(n){return n.slice(1,33)}i(Tt,{decrypt:()=>Ht,encrypt:()=>Ct}),"undefined"!=typeof crypto&&!crypto.subtle&&crypto.webcrypto&&(crypto.subtle=crypto.webcrypto.subtle);var $t={};i($t,{NIP05_REGEX:()=>Kt,queryProfile:()=>zt,searchDomain:()=>qt,useFetchImplementation:()=>jt});var Nt,Kt=/^(?:([\w.+-]+)@)?([\w.-]+)$/;try{Nt=fetch}catch{}function jt(n){Nt=n}async function qt(n,e=""){try{return(await(await Nt(`https://${n}/.well-known/nostr.json?name=${e}`)).json()).names}catch(n){return{}}}async function zt(n){const e=n.match(Kt);if(!e)return null;const[t,r="_",i]=e;try{const n=await Nt(`https://${i}/.well-known/nostr.json?name=${r}`),{names:e,relays:t}=function(n){const e={names:{}};for(const[t,r]of Object.entries(n.names))"string"==typeof t&&"string"==typeof r&&(e.names[t]=r);if(n.relays){e.relays={};for(const[t,r]of Object.entries(n.relays))"string"==typeof t&&Array.isArray(r)&&(e.relays[t]=r.filter((n=>"string"==typeof n)))}return e}(await n.json()),o=e[r];return o?{pubkey:o,relays:t?.[o]}:null}catch(n){return null}}var Pt={};i(Pt,{generateSeedWords:()=>Kr,privateKeyFromSeedWords:()=>Nr,validateWords:()=>jr});var Ft="abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo".split("\n");function Dt(n,e,t,r){const{c:i,dkLen:o,DK:s,PRF:a,PRFSalt:l}=function(n,e,t,r){c.hash(n);const i=v({dkLen:32,asyncTick:10},r),{c:o,dkLen:s,asyncTick:a}=i;if(c.number(o),c.number(s),c.number(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const l=w(e),u=w(t),h=new Uint8Array(s),d=Tn.create(n,l),f=d._cloneInto().update(u);return{c:o,dkLen:s,asyncTick:a,DK:h,PRF:d,PRFSalt:f}}(n,e,t,r);let u;const d=new Uint8Array(4),f=h(d),p=new Uint8Array(a.outputLen);for(let n=1,e=0;e<o;n++,e+=a.outputLen){const t=s.subarray(e,e+a.outputLen);f.setInt32(0,n,!1),(u=l._cloneInto(u)).update(d).digestInto(p),t.set(p.subarray(0,t.length));for(let n=1;n<i;n++){a._cloneInto(u).update(p).digestInto(p);for(let n=0;n<t.length;n++)t[n]^=p[n]}}return function(n,e,t,r,i){return n.destroy(),e.destroy(),r&&r.destroy(),i.fill(0),t}(a,l,s,u,p)}var Vt=BigInt(2**32-1),Mt=BigInt(32);function Zt(n,e=!1){return e?{h:Number(n&Vt),l:Number(n>>Mt&Vt)}:{h:0|Number(n>>Mt&Vt),l:0|Number(n&Vt)}}var Gt={fromBig:Zt,split:function(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let i=0;i<n.length;i++){const{h:o,l:s}=Zt(n[i],e);[t[i],r[i]]=[o,s]}return[t,r]},toBig:(n,e)=>BigInt(n>>>0)<<Mt|BigInt(e>>>0),shrSH:(n,e,t)=>n>>>t,shrSL:(n,e,t)=>n<<32-t|e>>>t,rotrSH:(n,e,t)=>n>>>t|e<<32-t,rotrSL:(n,e,t)=>n<<32-t|e>>>t,rotrBH:(n,e,t)=>n<<64-t|e>>>t-32,rotrBL:(n,e,t)=>n>>>t-32|e<<64-t,rotr32H:(n,e)=>e,rotr32L:(n,e)=>n,rotlSH:(n,e,t)=>n<<t|e>>>32-t,rotlSL:(n,e,t)=>e<<t|n>>>32-t,rotlBH:(n,e,t)=>e<<t-32|n>>>64-t,rotlBL:(n,e,t)=>n<<t-32|e>>>64-t,add:function(n,e,t,r){const i=(e>>>0)+(r>>>0);return{h:n+t+(i/2**32|0)|0,l:0|i}},add3L:(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),add3H:(n,e,t,r)=>e+t+r+(n/2**32|0)|0,add4L:(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),add4H:(n,e,t,r,i)=>e+t+r+i+(n/2**32|0)|0,add5H:(n,e,t,r,i,o)=>e+t+r+i+o+(n/2**32|0)|0,add5L:(n,e,t,r,i)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)},[Wt,Jt]=Gt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((n=>BigInt(n)))),Yt=new Uint32Array(80),Qt=new Uint32Array(80),Xt=class extends k{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:n,Al:e,Bh:t,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:l,Fh:u,Fl:h,Gh:d,Gl:f,Hh:p,Hl:y}=this;return[n,e,t,r,i,o,s,a,c,l,u,h,d,f,p,y]}set(n,e,t,r,i,o,s,a,c,l,u,h,d,f,p,y){this.Ah=0|n,this.Al=0|e,this.Bh=0|t,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|h,this.Gh=0|d,this.Gl=0|f,this.Hh=0|p,this.Hl=0|y}process(n,e){for(let t=0;t<16;t++,e+=4)Yt[t]=n.getUint32(e),Qt[t]=n.getUint32(e+=4);for(let n=16;n<80;n++){const e=0|Yt[n-15],t=0|Qt[n-15],r=Gt.rotrSH(e,t,1)^Gt.rotrSH(e,t,8)^Gt.shrSH(e,t,7),i=Gt.rotrSL(e,t,1)^Gt.rotrSL(e,t,8)^Gt.shrSL(e,t,7),o=0|Yt[n-2],s=0|Qt[n-2],a=Gt.rotrSH(o,s,19)^Gt.rotrBH(o,s,61)^Gt.shrSH(o,s,6),c=Gt.rotrSL(o,s,19)^Gt.rotrBL(o,s,61)^Gt.shrSL(o,s,6),l=Gt.add4L(i,c,Qt[n-7],Qt[n-16]),u=Gt.add4H(l,r,a,Yt[n-7],Yt[n-16]);Yt[n]=0|u,Qt[n]=0|l}let{Ah:t,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:l,Eh:u,El:h,Fh:d,Fl:f,Gh:p,Gl:y,Hh:g,Hl:w}=this;for(let n=0;n<80;n++){const e=Gt.rotrSH(u,h,14)^Gt.rotrSH(u,h,18)^Gt.rotrBH(u,h,41),b=Gt.rotrSL(u,h,14)^Gt.rotrSL(u,h,18)^Gt.rotrBL(u,h,41),m=u&d^~u&p,v=h&f^~h&y,E=Gt.add5L(w,b,v,Jt[n],Qt[n]),x=Gt.add5H(E,g,e,m,Wt[n],Yt[n]),k=0|E,A=Gt.rotrSH(t,r,28)^Gt.rotrBH(t,r,34)^Gt.rotrBH(t,r,39),B=Gt.rotrSL(t,r,28)^Gt.rotrBL(t,r,34)^Gt.rotrBL(t,r,39),S=t&i^t&s^i&s,I=r&o^r&a^o&a;g=0|p,w=0|y,p=0|d,y=0|f,d=0|u,f=0|h,({h:u,l:h}=Gt.add(0|c,0|l,0|x,0|k)),c=0|s,l=0|a,s=0|i,a=0|o,i=0|t,o=0|r;const U=Gt.add3L(k,B,I);t=Gt.add3H(U,x,A,S),r=0|U}({h:t,l:r}=Gt.add(0|this.Ah,0|this.Al,0|t,0|r)),({h:i,l:o}=Gt.add(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=Gt.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:l}=Gt.add(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:h}=Gt.add(0|this.Eh,0|this.El,0|u,0|h)),({h:d,l:f}=Gt.add(0|this.Fh,0|this.Fl,0|d,0|f)),({h:p,l:y}=Gt.add(0|this.Gh,0|this.Gl,0|p,0|y)),({h:g,l:w}=Gt.add(0|this.Hh,0|this.Hl,0|g,0|w)),this.set(t,r,i,o,s,a,c,l,u,h,d,f,p,y,g,w)}roundClean(){Yt.fill(0),Qt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},nr=class extends Xt{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},er=class extends Xt{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},tr=class extends Xt{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}},rr=E((()=>new Xt)),ir=(E((()=>new nr)),E((()=>new er)),E((()=>new tr)),n=>""===n[0]);function or(n){if("string"!=typeof n)throw new TypeError("Invalid mnemonic type: "+typeof n);return n.normalize("NFKD")}function sr(n){const e=or(n),t=e.split(" ");if(![12,15,18,21,24].includes(t.length))throw new Error("Invalid mnemonic");return{nfkd:e,words:t}}function ar(n){c.bytes(n,16,20,24,28,32)}function cr(n,e=128){if(c.number(e),e%32!=0||e>256)throw new TypeError("Invalid entropy");return function(n,e){ar(n);const t=ur(e).encode(n);return t.join(ir(e)?"":" ")}(x(e/8),n)}var lr=n=>{const e=8-n.length/4;return new Uint8Array([O(n)[0]>>e<<e])};function ur(n){if(!Array.isArray(n)||2048!==n.length||"string"!=typeof n[0])throw new Error("Worlist: expected array of 2048 strings");return n.forEach((n=>{if("string"!=typeof n)throw new Error(`Wordlist: non-string element: ${n}`)})),nt.chain(nt.checksum(1,lr),nt.radix2(11,!0),nt.alphabet(n))}function hr(n,e){try{!function(n,e){const{words:t}=sr(n),r=ur(e).decode(t);ar(r)}(n,e)}catch(n){return!1}return!0}var dr=n=>or(`mnemonic${n}`);var fr=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),pr=Uint8Array.from({length:16},((n,e)=>e)),yr=pr.map((n=>(9*n+5)%16)),gr=[pr],wr=[yr];for(let n=0;n<4;n++)for(let e of[gr,wr])e.push(e[n].map((n=>fr[n])));var br=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map((n=>new Uint8Array(n))),mr=gr.map(((n,e)=>n.map((n=>br[e][n])))),vr=wr.map(((n,e)=>n.map((n=>br[e][n])))),Er=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),xr=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),kr=(n,e)=>n<<e|n>>>32-e;function Ar(n,e,t,r){return 0===n?e^t^r:1===n?e&t|~e&r:2===n?(e|~t)^r:3===n?e&r|t&~r:e^(t|~r)}var Br,Sr=new Uint32Array(16),Ir=class extends k{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:n,h1:e,h2:t,h3:r,h4:i}=this;return[n,e,t,r,i]}set(n,e,t,r,i){this.h0=0|n,this.h1=0|e,this.h2=0|t,this.h3=0|r,this.h4=0|i}process(n,e){for(let t=0;t<16;t++,e+=4)Sr[t]=n.getUint32(e,!0);let t=0|this.h0,r=t,i=0|this.h1,o=i,s=0|this.h2,a=s,c=0|this.h3,l=c,u=0|this.h4,h=u;for(let n=0;n<5;n++){const e=4-n,d=Er[n],f=xr[n],p=gr[n],y=wr[n],g=mr[n],w=vr[n];for(let e=0;e<16;e++){const r=kr(t+Ar(n,i,s,c)+Sr[p[e]]+d,g[e])+u|0;t=u,u=c,c=0|kr(s,10),s=i,i=r}for(let n=0;n<16;n++){const t=kr(r+Ar(e,o,a,l)+Sr[y[n]]+f,w[n])+h|0;r=h,h=l,l=0|kr(a,10),a=o,o=t}}this.set(this.h1+s+l|0,this.h2+c+h|0,this.h3+u+r|0,this.h4+t+o|0,this.h0+i+a|0)}roundClean(){Sr.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}},Ur=E((()=>new Ir)),Lr=zn.ProjectivePoint,Or=(Br=O,ze(Xe(4,(n=>Br(Br(n)))),st));function _r(n){return BigInt(`0x${p(n)}`)}var Tr=g("Bitcoin seed"),Cr={private:76066276,public:76067358},Hr=2147483648,Rr=n=>{if(!Number.isSafeInteger(n)||n<0||n>2**32-1)throw new Error(`Invalid number=${n}. Should be from 0 to 2 ** 32 - 1`);const e=new Uint8Array(4);return h(e).setUint32(0,n,!1),e},$r=class{get fingerprint(){if(!this.pubHash)throw new Error("No publicKey set!");return n=this.pubHash,h(n).getUint32(0,!1);var n}get identifier(){return this.pubHash}get pubKeyHash(){return this.pubHash}get privateKey(){return this.privKeyBytes||null}get publicKey(){return this.pubKey||null}get privateExtendedKey(){const n=this.privateKey;if(!n)throw new Error("No private key");return Or.encode(this.serialize(this.versions.private,b(new Uint8Array([0]),n)))}get publicExtendedKey(){if(!this.pubKey)throw new Error("No public key");return Or.encode(this.serialize(this.versions.public,this.pubKey))}static fromMasterSeed(n,e=Cr){if(a(n),8*n.length<128||8*n.length>512)throw new Error(`HDKey: wrong seed length=${n.length}. Should be between 128 and 512 bits; 256 bits is advised)`);const t=Tn(rr,Tr,n);return new $r({versions:e,chainCode:t.slice(32),privateKey:t.slice(0,32)})}static fromExtendedKey(n,e=Cr){const t=Or.decode(n),r=h(t),i=r.getUint32(0,!1),o={versions:e,depth:t[4],parentFingerprint:r.getUint32(5,!1),index:r.getUint32(9,!1),chainCode:t.slice(13,45)},s=t.slice(45),a=0===s[0];if(i!==e[a?"private":"public"])throw new Error("Version mismatch");return new $r(a?{...o,privateKey:s.slice(1)}:{...o,publicKey:s})}static fromJSON(n){return $r.fromExtendedKey(n.xpriv)}constructor(n){if(this.depth=0,this.index=0,this.chainCode=null,this.parentFingerprint=0,!n||"object"!=typeof n)throw new Error("HDKey.constructor must not be called directly");if(this.versions=n.versions||Cr,this.depth=n.depth||0,this.chainCode=n.chainCode,this.index=n.index||0,this.parentFingerprint=n.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");if(n.publicKey&&n.privateKey)throw new Error("HDKey: publicKey and privateKey at same time.");if(n.privateKey){if(!zn.utils.isValidPrivateKey(n.privateKey))throw new Error("Invalid private key");this.privKey="bigint"==typeof n.privateKey?n.privateKey:_r(n.privateKey),this.privKeyBytes=y(this.privKey.toString(16).padStart(64,"0")),this.pubKey=zn.getPublicKey(n.privateKey,!0)}else{if(!n.publicKey)throw new Error("HDKey: no public or private key provided");this.pubKey=Lr.fromHex(n.publicKey).toRawBytes(!0)}var e;this.pubHash=(e=this.pubKey,Ur(O(e)))}derive(n){if(!/^[mM]'?/.test(n))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(n))return this;const e=n.replace(/^[mM]'?\//,"").split("/");let t=this;for(const n of e){const e=/^(\d+)('?)$/.exec(n);if(!e||3!==e.length)throw new Error(`Invalid child index: ${n}`);let r=+e[1];if(!Number.isSafeInteger(r)||r>=Hr)throw new Error("Invalid index");"'"===e[2]&&(r+=Hr),t=t.deriveChild(r)}return t}deriveChild(n){if(!this.pubKey||!this.chainCode)throw new Error("No publicKey or chainCode set");let e=Rr(n);if(n>=Hr){const n=this.privateKey;if(!n)throw new Error("Could not derive hardened child key");e=b(new Uint8Array([0]),n,e)}else e=b(this.pubKey,e);const t=Tn(rr,this.chainCode,e),r=_r(t.slice(0,32)),i=t.slice(32);if(!zn.utils.isValidPrivateKey(r))throw new Error("Tweak bigger than curve order");const o={versions:this.versions,chainCode:i,depth:this.depth+1,parentFingerprint:this.fingerprint,index:n};try{if(this.privateKey){const n=fn(this.privKey+r,zn.CURVE.n);if(!zn.utils.isValidPrivateKey(n))throw new Error("The tweak was out of range or the resulted private key is invalid");o.privateKey=n}else{const n=Lr.fromHex(this.pubKey).add(Lr.fromPrivateKey(r));if(n.equals(Lr.ZERO))throw new Error("The tweak was equal to negative P, which made the result key invalid");o.publicKey=n.toRawBytes(!0)}return new $r(o)}catch(e){return this.deriveChild(n+1)}}sign(n){if(!this.privateKey)throw new Error("No privateKey set!");return a(n,32),zn.sign(n,this.privKey).toCompactRawBytes()}verify(n,e){if(a(n,32),a(e,64),!this.publicKey)throw new Error("No publicKey set!");let t;try{t=zn.Signature.fromCompact(e)}catch(n){return!1}return zn.verify(t,n,this.publicKey)}wipePrivateData(){return this.privKey=void 0,this.privKeyBytes&&(this.privKeyBytes.fill(0),this.privKeyBytes=void 0),this}toJSON(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}}serialize(n,e){if(!this.chainCode)throw new Error("No chainCode set");return a(e,33),b(Rr(n),new Uint8Array([this.depth]),Rr(this.parentFingerprint),Rr(this.index),this.chainCode,e)}};function Nr(n,e){let t=$r.fromMasterSeed(function(n,e=""){return Dt(rr,sr(n).nfkd,dr(e),{c:2048,dkLen:64})}(n,e)),r=t.derive("m/44'/1237'/0'/0/0").privateKey;if(!r)throw new Error("could not derive private key");return p(r)}function Kr(){return cr(Ft)}function jr(n){return hr(n,Ft)}var qr={};function zr(n){const e={reply:void 0,root:void 0,mentions:[],profiles:[]},t=[];for(const r of n.tags)"e"===r[0]&&r[1]&&t.push(r),"p"===r[0]&&r[1]&&e.profiles.push({pubkey:r[1],relays:r[2]?[r[2]]:[]});for(let n=0;n<t.length;n++){const r=t[n],[i,o,s,a]=r,c={id:o,relays:s?[s]:[]},l=0===n,u=n===t.length-1;"root"!==a?"reply"!==a?"mention"!==a?l?e.root=c:u?e.reply=c:e.mentions.push(c):e.mentions.push(c):e.reply=c:e.root=c}return e}i(qr,{parse:()=>zr});var Pr={};function Fr(n){let e=0;for(let t=0;t<n.length;t++){const r=parseInt(n[t],16);if(0!==r){e+=Math.clz32(r)-28;break}e+=4}return e}i(Pr,{getPow:()=>Fr});var Dr={};function Vr(n,e,t,r){return we({kind:6,tags:[...n.tags??[],["e",e.id,t],["p",e.pubkey]],content:""===n.content?"":JSON.stringify(e),created_at:n.created_at},r)}function Mr(n){if(6!==n.kind)return;let e,t;for(let r=n.tags.length-1;r>=0&&(void 0===e||void 0===t);r--){const i=n.tags[r];i.length>=2&&("e"===i[0]&&void 0===e?e=i:"p"===i[0]&&void 0===t&&(t=i))}return void 0!==e?{id:e[1],relays:[e[2],t?.[2]].filter((n=>"string"==typeof n)),author:t?.[1]}:void 0}function Zr(n,{skipVerification:e}={}){const t=Mr(n);if(void 0===t||""===n.content)return;let r;try{r=JSON.parse(n.content)}catch(n){return}return r.id===t.id&&(e||xe(r))?r:void 0}i(Dr,{finishRepostEvent:()=>Vr,getRepostedEvent:()=>Zr,getRepostedEventPointer:()=>Mr});var Gr={};i(Gr,{NOSTR_URI_REGEX:()=>Wr,parse:()=>Yr,test:()=>Jr});var Wr=new RegExp(`nostr:(${wt.source})`);function Jr(n){return"string"==typeof n&&new RegExp(`^${Wr.source}$`).test(n)}function Yr(n){const e=n.match(new RegExp(`^${Wr.source}$`));if(!e)throw new Error(`Invalid Nostr URI: ${n}`);return{uri:e[0],value:e[1],decoded:bt(e[1])}}var Qr={};function Xr(n,e,t){const r=e.tags.filter((n=>n.length>=2&&("e"===n[0]||"p"===n[0])));return we({...n,kind:7,tags:[...n.tags??[],...r,["e",e.id],["p",e.pubkey]],content:n.content??"+"},t)}function ni(n){if(7!==n.kind)return;let e,t;for(let r=n.tags.length-1;r>=0&&(void 0===e||void 0===t);r--){const i=n.tags[r];i.length>=2&&("e"===i[0]&&void 0===e?e=i:"p"===i[0]&&void 0===t&&(t=i))}return void 0!==e&&void 0!==t?{id:e[1],relays:[e[2],t[2]].filter((n=>void 0!==n)),author:t[1]}:void 0}i(Qr,{finishReactionEvent:()=>Xr,getReactedEventPointer:()=>ni});var ei={};function ti(n,e){let t=[];(e.kind||-1)>=0&&t.push(`kind=${e.kind}`),e.until&&t.push(`created_at<${e.until}`),e.since&&t.push(`created_at>${e.since}`);let r=t.join("&");if(""===r)throw new Error("refusing to create a delegation without any conditions");let i=O(ce.encode(`nostr:delegation:${e.pubkey}:${r}`)),o=p(re.sign(i,n));return{from:oe(n),to:e.pubkey,cond:r,sig:o}}function ri(n){let e=n.tags.find((n=>"delegation"===n[0]&&n.length>=4));if(!e)return null;let t=e[1],r=e[2],i=e[3],o=r.split("&");for(let e=0;e<o.length;e++){let[t,r,i]=o[e].split(/\b/);if(("kind"!==t||"="!==r||n.kind!==parseInt(i))&&!("created_at"===t&&"<"===r&&n.created_at<parseInt(i)||"created_at"===t&&">"===r&&n.created_at>parseInt(i)))return null}let s=O(ce.encode(`nostr:delegation:${n.pubkey}:${r}`));return re.verify(i,s,t)?t:null}i(ei,{createDelegation:()=>ti,getDelegator:()=>ri});var ii={};i(ii,{matchAll:()=>si,regex:()=>oi,replaceAll:()=>ai});var oi=()=>new RegExp(`\\b${Wr.source}\\b`,"g");function*si(n){const e=n.matchAll(oi());for(const n of e)try{const[e,t]=n;yield{uri:e,value:t,decoded:bt(t),start:n.index,end:n.index+e.length}}catch(n){}}function ai(n,e){return n.replaceAll(oi(),((n,t)=>e({uri:n,value:t,decoded:bt(t)})))}var ci={};i(ci,{channelCreateEvent:()=>ui,channelHideMessageEvent:()=>fi,channelMessageEvent:()=>di,channelMetadataEvent:()=>hi,channelMuteUserEvent:()=>pi});var li,ui=(n,e)=>{let t;if("object"==typeof n.content)t=JSON.stringify(n.content);else{if("string"!=typeof n.content)return;t=n.content}return we({kind:40,tags:[...n.tags??[]],content:t,created_at:n.created_at},e)},hi=(n,e)=>{let t;if("object"==typeof n.content)t=JSON.stringify(n.content);else{if("string"!=typeof n.content)return;t=n.content}return we({kind:41,tags:[["e",n.channel_create_event_id],...n.tags??[]],content:t,created_at:n.created_at},e)},di=(n,e)=>{const t=[["e",n.channel_create_event_id,n.relay_url,"root"]];return n.reply_to_channel_message_event_id&&t.push(["e",n.reply_to_channel_message_event_id,n.relay_url,"reply"]),we({kind:42,tags:[...t,...n.tags??[]],content:n.content,created_at:n.created_at},e)},fi=(n,e)=>{let t;if("object"==typeof n.content)t=JSON.stringify(n.content);else{if("string"!=typeof n.content)return;t=n.content}return we({kind:43,tags:[["e",n.channel_message_event_id],...n.tags??[]],content:t,created_at:n.created_at},e)},pi=(n,e)=>{let t;if("object"==typeof n.content)t=JSON.stringify(n.content);else{if("string"!=typeof n.content)return;t=n.content}return we({kind:44,tags:[["p",n.pubkey_to_mute],...n.tags??[]],content:t,created_at:n.created_at},e)},yi={};i(yi,{useFetchImplementation:()=>gi,validateGithub:()=>wi});try{li=fetch}catch{}function gi(n){li=n}async function wi(n,e,t){try{return await(await li(`https://gist.github.com/${e}/${t}/raw`)).text()===`Verifying that I control the following Nostr public key: ${n}`}catch(n){return!1}}var bi={};i(bi,{authenticate:()=>mi});var mi=async({challenge:n,relay:e,sign:t})=>{const r={kind:22242,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e.url],["challenge",n]],content:""};return e.auth(await t(r))},vi={};i(vi,{decrypt:()=>ji,encrypt:()=>Ki,getSharedSecret:()=>Ni});var Ei=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4));if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function xi(n){if("string"!=typeof n)throw new Error("utf8ToBytes expected string, got "+typeof n);return new Uint8Array((new TextEncoder).encode(n))}function ki(n){if("string"==typeof n&&(n=xi(n)),!(n instanceof Uint8Array))throw new Error("expected Uint8Array, got "+typeof n);return n}function Ai(n,e){if(void 0!==e&&("object"!=typeof e||(t=e,"[object Object]"!==Object.prototype.toString.call(t)||t.constructor!==Object)))throw new Error("options must be object or undefined");var t;return Object.assign(n,e)}function Bi(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function Si(n,...e){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}var Ii={number:Bi,bool:function(n){if("boolean"!=typeof n)throw new Error(`Expected boolean, not ${n}`)},bytes:Si,hash:function(n){if("function"!=typeof n||"function"!=typeof n.create)throw new Error("hash must be wrapped by utils.wrapConstructor");Bi(n.outputLen),Bi(n.blockLen)},exists:function(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")},output:function(n,e){Si(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}},Ui=(n,e)=>255&n[e++]|(255&n[e++])<<8,Li=class{constructor(n){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,function(n,e){if(!(n instanceof Uint8Array))throw new Error("Uint8Array expected");if("number"==typeof e&&n.length!==e)throw new Error(`Uint8Array length ${e} expected`)}(n=ki(n),32);const e=Ui(n,0),t=Ui(n,2),r=Ui(n,4),i=Ui(n,6),o=Ui(n,8),s=Ui(n,10),a=Ui(n,12),c=Ui(n,14);this.r[0]=8191&e,this.r[1]=8191&(e>>>13|t<<3),this.r[2]=7939&(t>>>10|r<<6),this.r[3]=8191&(r>>>7|i<<9),this.r[4]=255&(i>>>4|o<<12),this.r[5]=o>>>1&8190,this.r[6]=8191&(o>>>14|s<<2),this.r[7]=8065&(s>>>11|a<<5),this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127;for(let e=0;e<8;e++)this.pad[e]=Ui(n,16+2*e)}process(n,e,t=!1){const r=t?0:2048,{h:i,r:o}=this,s=o[0],a=o[1],c=o[2],l=o[3],u=o[4],h=o[5],d=o[6],f=o[7],p=o[8],y=o[9],g=Ui(n,e+0),w=Ui(n,e+2),b=Ui(n,e+4),m=Ui(n,e+6),v=Ui(n,e+8),E=Ui(n,e+10),x=Ui(n,e+12),k=Ui(n,e+14);let A=i[0]+(8191&g),B=i[1]+(8191&(g>>>13|w<<3)),S=i[2]+(8191&(w>>>10|b<<6)),I=i[3]+(8191&(b>>>7|m<<9)),U=i[4]+(8191&(m>>>4|v<<12)),L=i[5]+(v>>>1&8191),O=i[6]+(8191&(v>>>14|E<<2)),_=i[7]+(8191&(E>>>11|x<<5)),T=i[8]+(8191&(x>>>8|k<<8)),C=i[9]+(k>>>5|r),H=0,R=H+A*s+B*(5*y)+S*(5*p)+I*(5*f)+U*(5*d);H=R>>>13,R&=8191,R+=L*(5*h)+O*(5*u)+_*(5*l)+T*(5*c)+C*(5*a),H+=R>>>13,R&=8191;let $=H+A*a+B*s+S*(5*y)+I*(5*p)+U*(5*f);H=$>>>13,$&=8191,$+=L*(5*d)+O*(5*h)+_*(5*u)+T*(5*l)+C*(5*c),H+=$>>>13,$&=8191;let N=H+A*c+B*a+S*s+I*(5*y)+U*(5*p);H=N>>>13,N&=8191,N+=L*(5*f)+O*(5*d)+_*(5*h)+T*(5*u)+C*(5*l),H+=N>>>13,N&=8191;let K=H+A*l+B*c+S*a+I*s+U*(5*y);H=K>>>13,K&=8191,K+=L*(5*p)+O*(5*f)+_*(5*d)+T*(5*h)+C*(5*u),H+=K>>>13,K&=8191;let j=H+A*u+B*l+S*c+I*a+U*s;H=j>>>13,j&=8191,j+=L*(5*y)+O*(5*p)+_*(5*f)+T*(5*d)+C*(5*h),H+=j>>>13,j&=8191;let q=H+A*h+B*u+S*l+I*c+U*a;H=q>>>13,q&=8191,q+=L*s+O*(5*y)+_*(5*p)+T*(5*f)+C*(5*d),H+=q>>>13,q&=8191;let z=H+A*d+B*h+S*u+I*l+U*c;H=z>>>13,z&=8191,z+=L*a+O*s+_*(5*y)+T*(5*p)+C*(5*f),H+=z>>>13,z&=8191;let P=H+A*f+B*d+S*h+I*u+U*l;H=P>>>13,P&=8191,P+=L*c+O*a+_*s+T*(5*y)+C*(5*p),H+=P>>>13,P&=8191;let F=H+A*p+B*f+S*d+I*h+U*u;H=F>>>13,F&=8191,F+=L*l+O*c+_*a+T*s+C*(5*y),H+=F>>>13,F&=8191;let D=H+A*y+B*p+S*f+I*d+U*h;H=D>>>13,D&=8191,D+=L*u+O*l+_*c+T*a+C*s,H+=D>>>13,D&=8191,H=(H<<2)+H|0,H=H+R|0,R=8191&H,H>>>=13,$+=H,i[0]=R,i[1]=$,i[2]=N,i[3]=K,i[4]=j,i[5]=q,i[6]=z,i[7]=P,i[8]=F,i[9]=D}finalize(){const{h:n,pad:e}=this,t=new Uint16Array(10);let r=n[1]>>>13;n[1]&=8191;for(let e=2;e<10;e++)n[e]+=r,r=n[e]>>>13,n[e]&=8191;n[0]+=5*r,r=n[0]>>>13,n[0]&=8191,n[1]+=r,r=n[1]>>>13,n[1]&=8191,n[2]+=r,t[0]=n[0]+5,r=t[0]>>>13,t[0]&=8191;for(let e=1;e<10;e++)t[e]=n[e]+r,r=t[e]>>>13,t[e]&=8191;t[9]-=8192;let i=(1^r)-1;for(let n=0;n<10;n++)t[n]&=i;i=~i;for(let e=0;e<10;e++)n[e]=n[e]&i|t[e];n[0]=65535&(n[0]|n[1]<<13),n[1]=65535&(n[1]>>>3|n[2]<<10),n[2]=65535&(n[2]>>>6|n[3]<<7),n[3]=65535&(n[3]>>>9|n[4]<<4),n[4]=65535&(n[4]>>>12|n[5]<<1|n[6]<<14),n[5]=65535&(n[6]>>>2|n[7]<<11),n[6]=65535&(n[7]>>>5|n[8]<<8),n[7]=65535&(n[8]>>>8|n[9]<<5);let o=n[0]+e[0];n[0]=65535&o;for(let t=1;t<8;t++)o=(n[t]+e[t]|0)+(o>>>16)|0,n[t]=65535&o}update(n){Ii.exists(this);const{buffer:e,blockLen:t}=this,r=(n=ki(n)).length;for(let i=0;i<r;){const o=Math.min(t-this.pos,r-i);if(o!==t)e.set(n.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===t&&(this.process(e,0,!1),this.pos=0);else for(;t<=r-i;i+=t)this.process(n,i)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(n){Ii.exists(this),Ii.output(n,this),this.finished=!0;const{buffer:e,h:t}=this;let{pos:r}=this;if(r){for(e[r++]=1;r<16;r++)e[r]=0;this.process(e,0,!0)}this.finalize();let i=0;for(let e=0;e<8;e++)n[i++]=t[e]>>>0,n[i++]=t[e]>>>8;return n}digest(){const{buffer:n,outputLen:e}=this;this.digestInto(n);const t=n.slice(0,e);return this.destroy(),t}};!function(n){const e=(e,t)=>n(t).update(ki(e)).digest(),t=n(new Uint8Array(32));e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=e=>n(e)}((n=>new Li(n)));var Oi=xi("expand 16-byte k"),_i=xi("expand 32-byte k"),Ti=Ei(Oi),Ci=Ei(_i),Hi=n=>!(n.byteOffset%4),Ri=(n,e)=>n<<e|n>>>32-e;var $i=(n=>{const{core:e,rounds:t,counterRight:r,counterLen:i,allow128bitKeys:o,extendNonceFn:s,blockLen:a}=Ai({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},n);Ii.number(i),Ii.number(t),Ii.number(a),Ii.bool(r),Ii.bool(o);const c=a/4;if(a%4!=0)throw new Error("Salsa/ChaCha: blockLen must be aligned to 4 bytes");return(n,l,u,h,d=0)=>{if(Ii.bytes(n),Ii.bytes(l),Ii.bytes(u),h||(h=new Uint8Array(u.length)),Ii.bytes(h),Ii.number(d),d<0||d>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(h.length<u.length)throw new Error(`Salsa/ChaCha: output (${h.length}) is shorter than data (${u.length})`);const f=[];let p,y;if(32===n.length)p=n,y=Ci;else{if(16!==n.length||!o)throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${n.length}`);p=new Uint8Array(32),p.set(n),p.set(n,16),y=Ti,f.push(p)}if(s){if(l.length<=16)throw new Error("Salsa/ChaCha: extended nonce must be bigger than 16 bytes");p=s(y,p,l.subarray(0,16),new Uint8Array(32)),f.push(p),l=l.subarray(16)}const g=16-i;if(l.length!==g)throw new Error(`Salsa/ChaCha: nonce must be ${g} or 16 bytes`);if(12!==g){const n=new Uint8Array(12);n.set(l,r?0:12-l.length),f.push(l=n)}const w=new Uint8Array(a),b=Ei(w),m=Ei(p),v=Ei(l),E=Hi(u)&&Ei(u),x=Hi(h)&&Ei(h);f.push(b);const k=u.length;for(let n=0,r=d;n<k;r++){if(e(y,m,v,b,r,t),r>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");const i=Math.min(a,k-n);if(i===a&&x&&E){const e=n/4;if(n%4!=0)throw new Error("Salsa/ChaCha: invalid block position");for(let n=0;n<c;n++)x[e+n]=E[e+n]^b[n];n+=a}else{for(let e=0;e<i;e++)h[n+e]=u[n+e]^w[e];n+=i}}for(let n=0;n<f.length;n++)f[n].fill(0);return h}})({core:function(n,e,t,r,i,o=20){let s=n[0],a=n[1],c=n[2],l=n[3],u=e[0],h=e[1],d=e[2],f=e[3],p=e[4],y=e[5],g=e[6],w=e[7],b=i,m=t[0],v=t[1],E=t[2],x=s,k=a,A=c,B=l,S=u,I=h,U=d,L=f,O=p,_=y,T=g,C=w,H=b,R=m,$=v,N=E;for(let n=0;n<o;n+=2)x=x+S|0,H=Ri(H^x,16),O=O+H|0,S=Ri(S^O,12),x=x+S|0,H=Ri(H^x,8),O=O+H|0,S=Ri(S^O,7),k=k+I|0,R=Ri(R^k,16),_=_+R|0,I=Ri(I^_,12),k=k+I|0,R=Ri(R^k,8),_=_+R|0,I=Ri(I^_,7),A=A+U|0,$=Ri($^A,16),T=T+$|0,U=Ri(U^T,12),A=A+U|0,$=Ri($^A,8),T=T+$|0,U=Ri(U^T,7),B=B+L|0,N=Ri(N^B,16),C=C+N|0,L=Ri(L^C,12),B=B+L|0,N=Ri(N^B,8),C=C+N|0,L=Ri(L^C,7),x=x+I|0,N=Ri(N^x,16),T=T+N|0,I=Ri(I^T,12),x=x+I|0,N=Ri(N^x,8),T=T+N|0,I=Ri(I^T,7),k=k+U|0,H=Ri(H^k,16),C=C+H|0,U=Ri(U^C,12),k=k+U|0,H=Ri(H^k,8),C=C+H|0,U=Ri(U^C,7),A=A+L|0,R=Ri(R^A,16),O=O+R|0,L=Ri(L^O,12),A=A+L|0,R=Ri(R^A,8),O=O+R|0,L=Ri(L^O,7),B=B+S|0,$=Ri($^B,16),_=_+$|0,S=Ri(S^_,12),B=B+S|0,$=Ri($^B,8),_=_+$|0,S=Ri(S^_,7);let K=0;r[K++]=s+x|0,r[K++]=a+k|0,r[K++]=c+A|0,r[K++]=l+B|0,r[K++]=u+S|0,r[K++]=h+I|0,r[K++]=d+U|0,r[K++]=f+L|0,r[K++]=p+O|0,r[K++]=y+_|0,r[K++]=g+T|0,r[K++]=w+C|0,r[K++]=b+H|0,r[K++]=m+R|0,r[K++]=v+$|0,r[K++]=E+N|0},counterRight:!1,counterLen:8,extendNonceFn:function(n,e,t,r){const i=Ei(e),o=Ei(t),s=Ei(r);let a=n[0],c=n[1],l=n[2],u=n[3],h=i[0],d=i[1],f=i[2],p=i[3],y=i[4],g=i[5],w=i[6],b=i[7],m=o[0],v=o[1],E=o[2],x=o[3];for(let n=0;n<20;n+=2)a=a+h|0,m=Ri(m^a,16),y=y+m|0,h=Ri(h^y,12),a=a+h|0,m=Ri(m^a,8),y=y+m|0,h=Ri(h^y,7),c=c+d|0,v=Ri(v^c,16),g=g+v|0,d=Ri(d^g,12),c=c+d|0,v=Ri(v^c,8),g=g+v|0,d=Ri(d^g,7),l=l+f|0,E=Ri(E^l,16),w=w+E|0,f=Ri(f^w,12),l=l+f|0,E=Ri(E^l,8),w=w+E|0,f=Ri(f^w,7),u=u+p|0,x=Ri(x^u,16),b=b+x|0,p=Ri(p^b,12),u=u+p|0,x=Ri(x^u,8),b=b+x|0,p=Ri(p^b,7),a=a+d|0,x=Ri(x^a,16),w=w+x|0,d=Ri(d^w,12),a=a+d|0,x=Ri(x^a,8),w=w+x|0,d=Ri(d^w,7),c=c+f|0,m=Ri(m^c,16),b=b+m|0,f=Ri(f^b,12),c=c+f|0,m=Ri(m^c,8),b=b+m|0,f=Ri(f^b,7),l=l+p|0,v=Ri(v^l,16),y=y+v|0,p=Ri(p^y,12),l=l+p|0,v=Ri(v^l,8),y=y+v|0,p=Ri(p^y,7),u=u+h|0,E=Ri(E^u,16),g=g+E|0,h=Ri(h^g,12),u=u+h|0,E=Ri(E^u,8),g=g+E|0,h=Ri(h^g,7);return s[0]=a,s[1]=c,s[2]=l,s[3]=u,s[4]=m,s[5]=v,s[6]=E,s[7]=x,r},allow128bitKeys:!1}),Ni=(n,e)=>O(zn.getSharedSecret(n,"02"+e).subarray(1,33));function Ki(n,e,t=1){if(1!==t)throw new Error("NIP44: unknown encryption version");const r=x(24),i=ce.encode(e),o=$i(n,r,i),s=new Uint8Array(25+o.length);return s.set([t],0),s.set(r,1),s.set(o,25),rt.encode(s)}function ji(n,e){let t=rt.decode(e);if(1!==t[0])throw new Error(`NIP44: unknown encryption version: ${t[0]}`);const r=t.slice(1,25),i=t.slice(25),o=$i(n,r,i);return ae.decode(o)}var qi,zi={};i(zi,{getZapEndpoint:()=>Fi,makeZapReceipt:()=>Mi,makeZapRequest:()=>Di,useFetchImplementation:()=>Pi,validateZapRequest:()=>Vi});try{qi=fetch}catch{}function Pi(n){qi=n}async function Fi(n){try{let e="",{lud06:t,lud16:r}=JSON.parse(n.content);if(t){let{words:n}=pt.decode(t,1e3),r=pt.fromWords(n);e=ae.decode(r)}else{if(!r)return null;{let[n,t]=r.split("@");e=`https://${t}/.well-known/lnurlp/${n}`}}let i=await qi(e),o=await i.json();if(o.allowsNostr&&o.nostrPubkey)return o.callback}catch(n){}return null}function Di({profile:n,event:e,amount:t,relays:r,comment:i=""}){if(!t)throw new Error("amount not given");if(!n)throw new Error("profile not given");let o={kind:9734,created_at:Math.round(Date.now()/1e3),content:i,tags:[["p",n],["amount",t.toString()],["relays",...r]]};return e&&o.tags.push(["e",e]),o}function Vi(n){let e;try{e=JSON.parse(n)}catch(n){return"Invalid zap request JSON."}if(!Ee(e))return"Zap request is not a valid Nostr event.";if(!xe(e))return"Invalid signature on zap request.";let t=e.tags.find((([n,e])=>"p"===n&&e));if(!t)return"Zap request doesn't have a 'p' tag.";if(!t[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=e.tags.find((([n,e])=>"e"===n&&e));return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":e.tags.find((([n,e])=>"relays"===n&&e))?null:"Zap request doesn't have a 'relays' tag."}function Mi({zapRequest:n,preimage:e,bolt11:t,paidAt:r}){let i=JSON.parse(n).tags.filter((([n])=>"e"===n||"p"===n||"a"===n)),o={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...i,["bolt11",t],["description",n]]};return e&&o.tags.push(["preimage",e]),o}var Zi={};i(Zi,{getToken:()=>Ji,unpackEventFromToken:()=>Qi,validateEvent:()=>Xi,validateToken:()=>Yi});var Gi,Wi="Nostr ";async function Ji(n,e,t,r=!1){if(!n||!e)throw new Error("Missing loginUrl or httpMethod");const i=ge(27235);i.tags=[["u",n],["method",e]],i.created_at=Math.round((new Date).getTime()/1e3);const o=await t(i);return(r?Wi:"")+rt.encode(ce.encode(JSON.stringify(o)))}async function Yi(n,e,t){const r=await Qi(n).catch((n=>{throw n}));return await Xi(r,e,t).catch((n=>{throw n}))}async function Qi(n){if(!n)throw new Error("Missing token");n=n.replace(Wi,"");const e=ae.decode(rt.decode(n));if(!e||0===e.length||!e.startsWith("{"))throw new Error("Invalid token");return JSON.parse(e)}async function Xi(n,e,t){if(!n)throw new Error("Invalid nostr event");if(!xe(n))throw new Error("Invalid nostr event, signature invalid");if(27235!==n.kind)throw new Error("Invalid nostr event, kind invalid");if(!n.created_at)throw new Error("Invalid nostr event, created_at invalid");if(Math.round((new Date).getTime()/1e3)-n.created_at>60)throw new Error("Invalid nostr event, expired");const r=n.tags.find((n=>"u"===n[0]));if(1!==r?.length&&r?.[1]!==e)throw new Error("Invalid nostr event, url tag invalid");const i=n.tags.find((n=>"method"===n[0]));if(1!==i?.length&&i?.[1].toLowerCase()!==t.toLowerCase())throw new Error("Invalid nostr event, method tag invalid");return!0}return Gi=o,((i,o,s,a)=>{if(o&&"object"==typeof o||"function"==typeof o)for(let c of t(o))r.call(i,c)||c===s||n(i,c,{get:()=>o[c],enumerable:!(a=e(o,c))||a.enumerable});return i})(n({},"__esModule",{value:!0}),Gi)})();
//# sourceMappingURL=/sm/a8a5c3641d75a156ff4f28d2dfa5461ed04df3d63e87346d96dbce8304e901d5.map